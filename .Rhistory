sst_annual <- sst_monthly %>% group_by(hmsTemp, year) %>%
summarise(mean_C = mean(monthly_mean),
max_C = mean(monthly_max),
min_C = mean(monthly_min),
cv_C = mean(monthly_cv)) %>%
ungroup()
sst_annual %>%
ggplot(aes(year, mean_C, color = hmsTemp)) +
geom_line()
sst_annual %>%
ggplot(aes(year, max_C, color = hmsTemp)) +
geom_line()
sst_annual %>%
ggplot(aes(year, min_C, color = hmsTemp)) +
geom_line()
sst_annual %>%
ggplot(aes(year, cv_C, color = hmsTemp)) +
geom_line()
sst_annual %>%
ggplot(aes(year, mean_C, color = hmsTemp)) +
geom_line()
sst_annual %>%
ggplot(aes(year, max_C, color = hmsTemp)) +
geom_line()
sst_monthly %>%
ggplot(aes(dateR, monthly_mean, color = hmsTemp)) +
geom_line()
elahi_sst_monthly <- sst_monthly %>% filter(year > 1937) %>% filter(hmsTemp == "corrected")
elahi_sst <- sst_annual %>% filter(year > 1937) %>% filter(hmsTemp == "corrected")
elahi_sst_monthly
monthly_sstL <- elahi_sst_monthly %>% gather(key = metric, value = tempC, monthly_mean:monthly_cv)
elahi_sst
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
sstL %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5)
elahi_sst_monthly
monthly_sstL
monthly_sstL %>%
ggplot(aes(dateR, tempC)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric)
elahi_sst_monthly <- sst_monthly %>% filter(year > 1937) %>% filter(hmsTemp == "corrected") %>%
select(-monthly_sd)
monthly_sstL <- elahi_sst_monthly %>% gather(key = metric, value = tempC, monthly_mean:monthly_cv)
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
monthly_sstL %>%
ggplot(aes(dateR, tempC)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric)
monthly_sstL %>%
ggplot(aes(dateR, tempC)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric) +
geom_smooth(method = "lm")
sst_annual
sstL %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5)
sstL %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric) +
geom_smooth(method = "lm")
sstL %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric, scales = "free") +
geom_smooth(method = "lm") +
theme(legend.position = "none")
sstL
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5) +
facet_wrap(~ metric, scales = "free") +
geom_smooth(method = "lm") +
theme(legend.position = "none")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line() + geom_point(alpha = 0.5) +
# facet_wrap(~ metric, scales = "free") +
geom_smooth(method = "lm") +
theme(legend.position = "none")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
labs(x = "Year", y = "Temperature (C)")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
ggtitle("Annual Sea Surface Temperature\n1944 - 2014") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
ggtitle("Annual Sea Surface Temperature\n1938 - 2015") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
# ggtitle("Annual Sea Surface Temperature\n1938 - 2015") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
sst_hms
head(sst_hms)
annual_quants <- sst_hms %>%  filter(year > 1937) %>% group_by(year) %>%
summarise(quantile_0.1 = quantile(tempC, 0.1),
quantile_0.5 = quantile(tempC, 0.5),
quantile_0.9 = quantile(tempC, 0.9))
annual_quants <- sst_hms %>%  filter(year > 1937) %>% group_by(year) %>%
summarise(quantile_0.1 = quantile(tempC, 0.1),
quantile_0.5 = quantile(tempC, 0.5),
quantile_0.9 = quantile(tempC, 0.9)) %>%
ungroup()
annual_quants
aql <- annual_quants %>% gather(key = quantileValue, value = tempC, quantile_0.1:quantile_0.9)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none")
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
# ggtitle("Annual Sea Surface Temperature\n1938 - 2015") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank())
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0,1), legend.justification = c(0,1))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none")
# theme(legend.title = element_blank()) +
# theme(legend.position = c(0,1), legend.justification = c(0,1))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
View(dm2)
source("02_sbs_size_dataPrep2.R")
head(dat2)
dat2 %>% select(species, year) %>% distinct()
dat2 %>% select(species, year) %>% distinct() %>% arrange(species, year)
spYrs <- dat2 %>% select(species, year) %>% distinct() %>% arrange(species, year)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = year, color = species))
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = year, color = species), data = spYrs)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species), data = spYrs)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3)
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3)
# theme(legend.title = element_blank()) +
# theme(legend.position = c(0,1), legend.justification = c(0,1))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE)
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = c(0,1), legend.justification = c(0,1))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = c(0,1), legend.justification = c(0,1)) +
theme(legend.key.size = unit(2, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = c(0,1), legend.justification = c(0,1)) +
theme(legend.key.size = unit(0.5, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = c(0,1), legend.justification = c(0,1)) +
theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "gray", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = species, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 7)
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
spYrs
strsplit("and.xys", split = ".")
strsplit
?strsplit
strsplit("and.xys", split = "\\.")
strsplit("and.xys", split = "\\.")[1]
unlist(strsplit("and.xys", split = "\\."))
unlist(strsplit("and.xys", split = "\\."))[1]
spYrs <- dat2 %>% select(species, year) %>% distinct() %>% arrange(species, year) %>%
mutate(genus = unlist(strsplit(species, split = "\\."))[1])
spYrs
spYrs <- dat2 %>% select(species, year) %>% distinct() %>% arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(species, split = "\\."))[1])
spYrs
spYrs <- dat2 %>% select(species, year) %>% distinct() %>% arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(species, split = "\\."))[1]) %>%
ungroup()
spYrs
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() + geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line() +
#geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line(alpha = 0.5) +
#geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
aql %>%
ggplot(aes(year, tempC, color = quantileValue)) +
geom_line(alpha = 1) +
#geom_point(alpha = 0.5) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
# theme(legend.position = "none") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
# theme(legend.position = c(0,1), legend.justification = c(0,1)) +
# theme(legend.key.size = unit(0.25, "cm"))
ggsave("figs/hms_temp_quantiles.png", height = 3.5, width = 3.5)
sst_annual
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 0.5) + geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
theme(legend.position = "none") +
# ggtitle("Annual Sea Surface Temperature\n1938 - 2015") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
scale_color_manual(values = c("blue", "black", "red")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
elahi_sst_monthly
elahi_sst <- elahi_sst_monthly %>% filter(year > 1937) %>%
group_by(year) %>%
summarise(mean_C = mean(monthly_mean),
max_C = max(monthly_mean),
min_C = min(monthly_mean),
cv_C = mean(monthly_cv))
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
sstL %>% filter(metric != "cv_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
