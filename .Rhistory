plot_spectra <- spectra_df %>%
ggplot(aes(freq, spec, color = metric))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra
spectra_df %>%
ggplot(aes(period, spec, color = metric))  +
geom_vline(aes(xintercept = 18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
scale_x_log10("Period (years)", breaks = rev(yrs.period),
labels = rev(yrs.labels)) +
ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
ggplot(df_per) +
geom_line(aes(x = period, y = spec)) +
scale_x_log10("Period (years)", breaks = rev(yrs.period), labels = rev(yrs.labels))
ggplot(df_per) +
geom_line(aes(x = period, y = spec)) +
scale_x_log10("Period (years)", breaks = yrs.period, labels = yrs.labels)
yrs.period
rev(yrs.period)
spectra_df %>%
ggplot(aes(period, spec, color = metric))  +
geom_vline(aes(xintercept = 18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
scale_x_log10("Period (years)", breaks = rev(yrs.period),
labels = rev(yrs.labels)) +
ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_period <- spectra_df %>%
ggplot(aes(period, spec, color = metric))  +
geom_vline(aes(xintercept = 18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
scale_x_log10("Period (years)", breaks = rev(yrs.period),
labels = rev(yrs.labels)) +
ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_period
ggsave("figs/temp_timeseries_spectra_period.png", height = 5, width = 7)
plot_resids_spectra_period <- plot_grid(plot_resids, plot_spectra_period,
labels = c("A", "B"), nrow = 2, align = "v")
ggsave("figs/temp_timeseries_spectra_period.png", height = 5, width = 7)
plot_resids
save_plot("figs/plot_resids_spectra_period.png", plot_resids_spectra_period,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3,
base_width = 7
)
ggplot(df_per) +
geom_line(aes(x = period, y = spec))
ggplot(df_per) +
geom_line(aes(x = period, y = spec)) +
scale_x_log10("Period (years)", breaks = rev(yrs.period), labels = rev(yrs.labels))
ggplot(df_per) +
geom_line(aes(x = freq, y = spec))
ggplot(df_per) +
geom_line(aes(x = freq, y = spec)) +
scale_x_continuous("Frequency", breaks = yrs.freqs)
ggplot(df_per) +
geom_line(aes(x = freq, y = spec)) +
scale_x_continuous("Frequency")
ggplot(df_per) +
geom_line(aes(x = freq, y = spec)) +
scale_x_continuous("Frequency",
sec.axis = sec_axis(~. + 10))
?ggplot2
??ggplot2
df_per
with(df_per, plot(freq, spec, type = "b", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "b", col = "black", bg = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
par(new = T)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
par(new = T)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = NA, xlab = NA, axes = F)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = NA, xlab = NA, axes = F))
axis(side = 4)
?axis
axis(side = 3)
axis(side = 3, labels = 1/freq)
axis(side = 3, labels = 1/df$perfreq)
axis(side = 3, labels = 1/df_per$freq)
axis(side = 3, labels = 1/df_per$freq, at = df_per$freq)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, labels = 1/df_per$freq, at = df_per$freq)
?axis
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = df_per$freq,
labels = round(1/df_per$freq, 2))
with(df_per, plot(period, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = df_per$freq,
labels = round(1/df_per$freq, 2))
plot_resids_spectra_min
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(expression(atop("Deviation from fitted", paste("temperature (", degree, "C)")))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_spectra_min <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(freq, spec, color = NULL))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
#facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min
plot_spectra_min_period <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(period, spec, color = NULL))  +
geom_vline(aes(xintercept = 18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Period (years)") + ylab("Spectrum") +
#facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min_period
plot_spectra_min_period <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(period, spec, color = NULL))  +
geom_vline(aes(xintercept = 18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
scale_x_log10("Period (years)", breaks = rev(yrs.period),
labels = rev(yrs.labels)) +  ylab("Spectrum") +
#facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min_period
plot_resids_spectra_min_period <- plot_grid(plot_resids_min, plot_spectra_min_period,
labels = c("A", "B"),
nrow = 1, align = "h")
save_plot("figs/plot_resids_spectra_min_period.png", plot_resids_spectra_min_period,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.2, base_height = 3.5
)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = df_per$freq,
labels = round(1/df_per$freq, 2))
mtext(side = 3, line = 3, "Period (years)")
df_per
yrs.period <- rev(c(1/6, 1/5, 1/4, 1/3, 0.5, 1, 3, 5, 10, 100))
yrs.labels <- rev(c("1/6", "1/5", "1/4", "1/3", "1/2", "1", "3", "5", "10",
"100"))
yrs.period <- rev(c(1, 2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("1", "2", "4", "8", "16", "32", "64"))
yrs.period <- rev(c(1, 2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("1", "2", "4", "8", "16", "32", "64"))
yrs.freqs <- 1/yrs.period * 1/12  #Convert annual period to annual freq, and then to monthly freq
yrs.freqs
yrs.period
?plot
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = yrs.freqs)
df_per
axis(side = 3, at = df_per$freq,
labels = round(period, 1))
axis(side = 3, at = df_per$freq,
labels = round(df_per$period, 1))
axis(side = 3, at = df_per$freq,
labels = round(df_per$period, 2))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = df_per$freq,
labels = round(df_per$period, 2))
?axis
axis(1, xaxp = c(2, 9, 7))
plot(1:10, xaxt = "n")
axis(1, xaxp = c(2, 9, 7))
axis(1, xaxp = c(2, 9, 7))
plot(1:10, xaxt = "n")
axis(1, xaxp = c(2,9,7))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
df_per
yrs.period <- rev(c(2, 4, 8, 16, 32, 64, 80))
yrs.labels <- rev(c("2", "4", "8", "16", "32", "64", "80"))
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = rev(yrs.period), labels = rev(yrs.labels))
yrs.period
axis(side = 3, at = yrs.period, labels = yrs.labels)
yrs.labels
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = yrs.period)
axis(side = 3, at = 1/yrs.period)
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
yrs.period <- rev(c(2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("2", "4", "8", "16", "32", "64"))
yrs.freqs <- 1/yrs.period * 1/12  #Convert annual period to annual freq, and then to monthly freq
df_per
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 18.6)
abline(v = 1/18.6)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"), size = 2)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"), size = 4)
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"), cex = 4)
?plot
with(df_per, plot(freq, spec, type = "l", col = "black",
ylab = "Spectrum",
xlab = "Frequency (1/years)"), lwd = 4)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 4,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, points(freq, spec, add = T))
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 2,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, points(freq, spec, add = T))
with(df_per, points(freq, spec, add = T, lwd = 2))
with(df_per, points(freq, spec, add = T, lwd = 2, pch = 16))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 2,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, points(freq, spec, add = T, lwd = 2, pch = 16))
with(df_per, lines(freq, spec, add = T, lwd = 2, pch = 16))
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, add = T, lwd = 2, pch = 16))
lines
?lines
?points
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
plot_resids_min
install.packages("gridBase")
par(mfrow = c(2,2), mar=c(0,0,0,0), oma=c(0,0,0,0))
# leave top-left quadrant empty!
plot.new()
# plot regular R graphic in top-right quadrant
plot(seq(1:10), seq(1:10), pch = 20)
vp <- iewport(height = unit(1,"npc"), width=unit(0.5, "npc"),
just = c("left","top"), y = 1, x = 0.5)
vp <- viewport(height = unit(1,"npc"), width=unit(0.5, "npc"),
just = c("left","top"), y = 1, x = 0.5)
library(gridBase)
vp <- viewport(height = unit(1,"npc"), width=unit(0.5, "npc"),
just = c("left","top"), y = 1, x = 0.5)
library(gridBase)
par(mfrow = c(2,2), mar=c(0,0,0,0), oma=c(0,0,0,0))
# leave top-left quadrant empty!
plot.new()
# plot regular R graphic in top-right quadrant
plot(seq(1:10), seq(1:10), pch = 20)
# now add the first ggplot element which is going to take
# up the left two quadrants
vp <- viewport(height = unit(1,"npc"), width=unit(0.5, "npc"),
just = c("left","top"), y = 1, x = 0.5)
?viewport
library(grid)
vp <- viewport(height = unit(1,"npc"), width=unit(0.5, "npc"),
just = c("left","top"), y = 1, x = 0.5)
print(my.first.ggplot.obj, vp = vp)
par(mfrow=c(2, 2))
plot(y,type = "l",xlab = "Time (hours)",ylab = "Amplitude",main = "Time series")
plot(wt.t1, plot.cb=FALSE, plot.phase=FALSE,main = "Continuous wavelet transform",
ylab = "Period (hours)",xlab = "Time (hours)")
spectrum(y,method = "ar",main = "Spectral density function",
xlab = "Frequency (cycles per hour)",ylab = "Spectrum")
par(mfrow = c(1,2), mar=c(0,0,0,0), oma=c(0,0,0,0))
yrs.period <- rev(c(2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("2", "4", "8", "16", "32", "64"))
df_per
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
dev.off()
yrs.period <- rev(c(2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("2", "4", "8", "16", "32", "64"))
df_per
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
png('figs/plot_spectra_min_period_base.png')
yrs.period <- rev(c(2, 4, 8, 16, 32, 64))
yrs.labels <- rev(c("2", "4", "8", "16", "32", "64"))
df_per
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
dev.off()
?png
png('figs/plot_spectra_min_period_base.png', height = 3.5, width = 3.5, res = 600, units = "in")
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
dev.off()
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 2)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 1)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 2)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 3)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 4)
png('figs/plot_spectra_min_period_base.png', height = 3.5, width = 3.5, res = 300, units = "in")
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 4)
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
dev.off()
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 2)
with(df_per, plot(freq, spec, type = "l", col = "black", lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"), las = 2)
with(df_per, plot(freq, spec, type = "l", col = "black", las = 2, lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 3, lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 4, lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 4, lwd = 1,
with(df_per, plot(freq, spec, type = "l", col = "black", las = 1, lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 1, lwd = 1,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
par(mfrow = c(1,2))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 1, lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
sessionInfo()
plot.new()              ## suggested by @Josh
vps <- baseViewports()
pushViewport(vps$figure) ##   I am in the space of the autocorrelation plot
vp1 <-plotViewport(c(1.8,1,0,1)) ## create new vp with margins, you play with this values
require(ggplot2)
acz <- acf(y, plot=F)
acd <- data.frame(lag=acz$lag, acf=acz$acf)
plot_spectra_min_period
plot_resids_min
with(df_per, plot(freq, spec, type = "l", col = "black", las = 1, lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
plot.new()              ## suggested by @Josh
vps <- baseViewports()
pushViewport(vps$figure) ##   I am in the space of the autocorrelation plot
vp1 <-plotViewport(c(1.8,1,0,1)) ## create new vp with margins, you play with this values
print(plot_resids_min, vp = vp1)
plot_resids_min
?baseViewports()
par(mfrow = c(1,2))
with(df_per, plot(freq, spec, type = "l", col = "black", las = 1, lwd = 0,
ylab = "Spectrum",
xlab = "Frequency (1/years)"))
axis(side = 3, at = 1/yrs.period, labels = yrs.labels)
mtext(side = 3, line = 3, "Period (years)")
abline(v = 1/18.6, col = "darkgray", lwd = 4)
with(df_per, lines(freq, spec, lwd = 2, pch = 16))
with(df_per, points(freq, spec, lwd = 2, pch = 16))
plot.new()              ## suggested
vps <- baseViewports()
vps
pushViewport(vps$figure) ##   I am in the space of the autocorrelation plot
vp1 <-plotViewport(c(1,1,0,1)) ## create new vp with margins, you play with this values
print(plot_resids_min, vp = vp1)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
