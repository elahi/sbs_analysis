fig1bSub <- ggplot(childsSubPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 683",
x = 18, y = 0.16, size = 2.2)
fig1b <- ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 733",
x = 18, y = 0.16, size = 2.2)
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 492",
x = 20, y = 0.15, size = 2.2)
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 587",
x = 20, y = 0.15, size = 2.2)
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
range(childsPres$tideHTm, na.rm = TRUE)
range(waraPres$tideHTm, na.rm = TRUE)
range(hexPres$tideHTm, na.rm = TRUE)
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 587\nTidal height (m) = 1.2-2.3",
x = 20, y = 0.15, size = 2.2)
ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 733\nTidal height (m) = 2.4-7.3",
x = 18, y = 0.16, size = 2.2)
ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\nTidal height (m) = 2.4-7.3\n2014\nn = 733",
x = 18, y = 0.16, size = 2.2)
ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 733\nTidal height = 2.4-7.3",
x = 18, y = 0.16, size = 2.2)
range(childsPres$tideHTm, na.rm = TRUE)
range(waraPres$tideHTm, na.rm = TRUE)
range(hexPres$tideHTm, na.rm = TRUE)
ULClabel <- theme(plot.title = element_text(hjust = -0.08, vjust = 1,
size = rel(1)))
no_legend <- theme(legend.position = "none")
fig1aSub <- ggplot(childsSubPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n1947\nn = 650",
x = 18, y = 0.16, size = 2.2)
fig1a <- ggplot(childsPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n1947\nn = 682",
x = 18, y = 0.16, size = 2.2)
fig1bSub <- ggplot(childsSubPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 683",
x = 18, y = 0.16, size = 2.2)
fig1b <- ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 733\nTidal height = 2.4-7.3",
x = 18, y = 0.16, size = 2.2)
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 492",
x = 20, y = 0.15, size = 2.2)
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 587\nTidal height (m) = 1.2-2.3",
x = 20, y = 0.15, size = 2.2)
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995\nTidal height (m) = 0.3-1.5",
x = 25, y = 0.25, size = 2.2)
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
grid.text("abc", x = unit(0.8, "npc"), y = unint(0.1, "nps"))
grid.text("abc", x = unit(0.8, "npc"), y = unit(0.1, "nps"))
grid.text("abc", x = unit(0.8, "npc"), y = unit(0.1, "npc"))
grid.text("abc", x = unit(0.1, "npc"), y = unit(0.1, "npc"))
grid.text("abc", x = unit(0., "npc"), y = unit(0.1, "npc"))
grid.text("abc", x = unit(0.2, "npc"), y = unit(0.1, "npc"))
grid.text("abc", x = unit(0.2, "npc"), y = unit(0.9, "npc"))
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.2, "npc"), y = unit(0.9, "npc"))
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.5, "npc"), y = unit(0.9, "npc"))
?grid.text
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.2, "npc"), y = unit(0.9, "npc"),
just = "left")
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.2, "npc"), y = unit(0.9, "npc"),
just = "left")
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.1, "npc"), y = unit(0.9, "npc"),
just = "left", fontsize = 2.2)
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.1, "npc"), y = unit(0.9, "npc"),
just = "left", gp = gpar(fontsize = 2.2))
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.1, "npc"), y = unit(0.9, "npc"),
just = "left", gp = gpar(fontsize = 7))
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) + grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.1, "npc"), y = unit(0.9, "npc"),
just = "left", gp = gpar(fontsize = 7))
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
grid.text("Tidal height (m) = 0.3-1.5", x = unit(0.1, "npc"), y = unit(0.9, "npc"),
just = "left", gp = gpar(fontsize = 7))
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
labs(x = "Tidal height (m) = 0.3-1.5")
range(childsPres$tideHTm, na.rm = TRUE)
range(waraPres$tideHTm, na.rm = TRUE)
range(hexPres$tideHTm, na.rm = TRUE)
ULClabel <- theme(plot.title = element_text(hjust = -0.08, vjust = 1,
size = rel(1)))
no_legend <- theme(legend.position = "none")
fig1aSub <- ggplot(childsSubPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n1947\nn = 650",
x = 18, y = 0.16, size = 2.2)
fig1a <- ggplot(childsPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n1947\nn = 682",
x = 18, y = 0.16, size = 2.2)
fig1bSub <- ggplot(childsSubPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 683",
x = 18, y = 0.16, size = 2.2)
fig1b <- ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 733",
x = 18, y = 0.16, size = 2.2)
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 492",
x = 20, y = 0.15, size = 2.2)
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 587",
x = 20, y = 0.15, size = 2.2)
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
###############################
# save as 7 x 3.5 pdf
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
annotation_custom(grob = "xyz")
?annotation_custom
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
annotation_custom(grob = "xyz", xmin = 10, xmax = 20, ymin = 0.1, ymax = 0.2)
annotation_custom(grob = textGrob("xyz"), xmin = 10, xmax = 20, ymin = 0.1, ymax = 0.2)
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
annotation_custom(grob = textGrob("xyz"), xmin = 10, xmax = 20, ymin = 0.1, ymax = 0.2)
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
annotation_custom(grob = textGrob("xyz"), xmin = 10, xmax = 20, ymin = 0.2, ymax = 0.3)
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
annotation_custom(grob = textGrob("xyz"), xmin = 10, xmax = 11, ymin = 0.3, ymax = 0.4)
ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
ggtitle("yxz")
library(ggplot2)
theme_set(theme_classic(base_size = 8))
library(dplyr)
library(lme4)
library(lmerTest)
rm(list=ls(all=TRUE))
# plotting functions
source("./R/multiplotF.R")
# load prepped data
dat <- read.csv("./output/sbsMaster.csv", na.strings = c("NA"))
chil <- droplevels(filter(dat, sp == "LIKE"))
summary(chil)
unique(chil$nest2)
# create random effect
names(chil)
randF <- function(x) return(as.factor(paste(x$nest1, x$nest2, sep="_")))
chil$rand1 <- randF(chil)
unique(chil$rand1)
### quick model
mod1 <- lmer(size1mm ~ era*nest1 + (1|rand1),
data = chil)
mod1
anova(mod1)
mod1 <- lm(size1mm ~ era*nest1,
data = chil)
anova(mod1)
qplot(era, size1mm, data = chil, facets = ~ nest1, geom = "boxplot")
qplot(size1mm, data = chil, color = era, facets = ~ nest1, geom = "density")
dat <- read.csv("./output/sbsMaster.csv", na.strings = c("NA"))
# change ft to meters
range(dat$tideHTm, na.rm = TRUE)
dat$tideHTm <- dat$tideHTm/3.28084
chil <- droplevels(filter(dat, sp == "LIKE"))
summary(chil)
factorList <- unique(chil$nest1)
factorList
range(chil$tideHTm, na.rm = TRUE)
unique(chil$tideHTm)
factorList2 <- c("2.4", "4.3", "5.8", "7.3")
factorList2
chil$tideHT <- mapvalues(chil$nest1, from = factorList, to = factorList2)
library(dplyr)
mapvalues
chil$tideHT <- plyr::mapvalues(chil$nest1, from = factorList, to = factorList2)
levels(chil$tideHT)
chil2 <- chil %>% mutate(tideHT = factor(nest1, levels = c("2.4", "4.3", "5.8", "7.3")))
head(chil2)
chil2 <- chil %>% mutate(tideHT = factor(tideHTm, levels = c("2.4", "4.3", "5.8", "7.3")))
head(chil2)
levels(chil$tideHT)
levels(chil$tideHT)
rev(levels(chil$tideHT))
qplot(size1mm, data = chil, color = era, facets = ~ tideHT, geom = "density")
qplot(size1mm, data = chil, color = era, facets = ~ rev(tideHT), geom = "density")
?factor
$tideHT <- plyr::mapvalues(chil$nest1, from = factorList, to = factorList2)
tideHT <- plyr::mapvalues(chil$nest1, from = factorList, to = factorList2)
factor(tideHT)
factor(tideHT, levels = c("7.3", "5.8", "4.3", "2.4"))
tideHT2 <- factor(tideHT, levels = c("7.3", "5.8", "4.3", "2.4"))
summary(tideHT2)
chil$tideHT <- tideHT2
qplot(size1mm, data = chil, color = era, facets = ~ tideHT, geom = "density")
ggplot(data = chil, aes(size1mm, color = era)) +
facet_wrap(~ tideHT, nrow = 4)
ggplot(data = chil, aes(size1mm, color = era)) +
facet_wrap(~ tideHT, nrow = 4) + geom_density()
p + geom_histogram()
p <- ggplot(data = chil, aes(size1mm, color = era)) +
facet_wrap(~ tideHT, nrow = 4)
p + geom_histogram()
p + boxplot()
p + box_plot()
p
p + geom_boxplot()
p <- ggplot(data = chil, aes(era, size1mm)) +
facet_wrap(~ tideHT, nrow = 4)
p + geom_boxplot()
ggsave("sbs_fig2.pdf", 3, 6)
p + geom_boxplot()
ggsave("sbs_fig2.pdf", 3, 6)
?ggsave
ggsave("sbs_fig2.pdf", width = 3, height = 6)
ggsave("./figs/sbs_fig2.pdf", width = 3, height = 6)
qplot(size1mm, data = chil, facets = era ~ tideHT, geom = "histogram")
qplot(size1mm, data = chil, facets = tideHT ~ era, geom = "histogram")
ggplot(chil,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(tideHT ~ era)
ggplot(chil,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(tideHT ~ era, scales = "free_y")
ggplot(chil,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(tideHT ~ era, scales = "free_y") +
xlab("Size (mm)") + ylab("Frequency (%)")
factorList2 <- c("2.4m", "4.3m", "5.8m", "7.3m")
factorList2
tideHT <- plyr::mapvalues(chil$nest1, from = factorList, to = factorList2)
# reorder the levels
tideHT2 <- factor(tideHT, levels = c("7.3m", "5.8m", "4.3m", "2.4m"))
chil$tideHT <- tideHT2
############################################
### plot
qplot(era, size1mm, data = chil, facets = ~ nest1, geom = "boxplot")
qplot(size1mm, data = chil, color = era, facets = ~ tideHT, geom = "density")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_grid(tideHT ~ era, scales = "free_y") +
xlab("Size (mm)") + ylab("Frequency (%)")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era))
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "free_y") +
xlab("Size (mm)") + ylab("Probability density")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "free_y", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density")
qplot(era, size1mm, data = chil, facets = ~ nest1, geom = "boxplot")
qplot(size1mm, data = chil, color = era, facets = ~ tideHT, geom = "density")
p <- ggplot(data = chil, aes(era, size1mm)) +
facet_wrap(~ tideHT, nrow = 4)
qplot(size1mm, data = chil, facets = tideHT ~ era, geom = "histogram")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "free_y", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density")
# histogram
ggplot(chil,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(tideHT ~ era, scales = "free_y") +
xlab("Size (mm)") + ylab("Frequency (%)")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "free_y", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density")
# histogram
ggplot(chil,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(tideHT ~ era, scales = "free_y") +
xlab("Size (mm)") + ylab("Frequency (%)")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "free_y", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density")
ggsave("./figs/sbs_fig2.pdf", width = 3, height = 6)
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density")
ggsave("./figs/sbs_fig2.pdf", width = 3, height = 6)
