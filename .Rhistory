xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
facet_wrap(~ zone, nrow = 4)
ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4)
ULClabel <- theme(plot.title = element_text(hjust = -0.2, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4)
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p1
ULClabel <- theme(plot.title = element_text(hjust = 0, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p1
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p1
multiplot(p1, p1, p1, cols = 1)
multiplot(p1, p1, p1, cols = 3)
pdf("./figs/crap.pdf", width = 3.5, height = 7)
multiplot(p1, p1, p1, cols = 3)
dev.off()
# save as pdf
pdf("./figs/crap.pdf", width = 7, height = 7)
multiplot(p1, p1, p1, cols = 3)
dev.off()
source("./R/summarizeData_150204.R")
# load prepped data
dat <- read.csv("./output/sbsMaster.csv", na.strings = c("NA"))
# change ft to meters
range(dat$tideHTm, na.rm = TRUE)
dat$tideHTm <- dat$tideHTm/3.28084
chil <- droplevels(filter(dat, sp == "LIKE"))
summary(chil)
unique(chil$nest2)
############################################
# get density stats
dens <- read.csv("./data/density_master.csv", na.strings = "NA")
dens
dens_stats <- summarySE(data = dens, measurevar = "dens_m2",
groupvars = c("nest1", "era"))
dens_stats
summarySE(data = dens, measurevar = "dens_m2", groupvars = "era")
############################################
# create new factor with tidal heights
factorList <- unique(chil$nest1)
factorList
factorList2 <- rev(c("7.2m", "6.0m", "3.9m", "2.8m"))
factorList <- unique(chil$nest1)
factorList
unique(chil$tideHTm)
factorList <- unique(chil$nest1)
factorList
unique(chil$tideHTm)
# original tidal heights
factorList2 <- c("2.7m", "3.8m", "5.9m", "7.3m")
# or new tidal heights (from temp loggers)
factorList2 <- rev(c("7.2m", "6.0m", "3.9m", "2.8m"))
factorList2
tideHT <- plyr::mapvalues(chil$nest1, from = factorList, to = factorList2)
tideHT2 <- factor(tideHT, levels = c("7.2m", "6.0m", "3.9m", "2.8m"))
chil$tideHT <- tideHT2
# density
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(color = era)) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
theme(legend.justification = c(1, 1), legend.position = c(0.97, 0.23),
legend.text = element_text(size = 6), legend.title = element_text(size = 6)) +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(fill = era)) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
theme(legend.justification = c(1, 1), legend.position = c(0.97, 0.23),
legend.text = element_text(size = 6), legend.title = element_text(size = 6)) +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(fill = era, alpha = 0.5)) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
theme(legend.justification = c(1, 1), legend.position = c(0.97, 0.23),
legend.text = element_text(size = 6), legend.title = element_text(size = 6)) +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm)) +
geom_density(aes(fill = era, alpha = 0.5)) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
scale_fill_manual(breaks = c("past", "present"),
values = c("darkgray", "white"))
ggplot(chil,  aes(x = size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
scale_fill_manual(breaks = c("past", "present"),
values = c("darkgray", "white")) +
theme(legend.position = "none") +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
scale_fill_manual(breaks = c("past", "present"),
values = c("darkgray", "white")) +
theme(legend.position = "none") +
theme(strip.background = element_blank(),
strip.text.x = element_blank()) +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
scale_fill_manual(breaks = c("past", "present"),
values = c("darkgray", "white")) +
theme(legend.position = "none") +
theme(strip.background = element_blank()) +
ggtitle("Littorina keenae")
ggplot(chil,  aes(x = size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap(~ tideHT, scales = "fixed", nrow = 4) +
xlab("Size (mm)") + ylab("Probability density") +
scale_fill_manual(breaks = c("past", "present"),
values = c("darkgray", "white")) +
theme(legend.position = "none") +
theme(strip.background = element_blank())
ggsave("./figs/childs_density.pdf", width = 3.5, height = 7)
p1
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(dat, aes(code, mean_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily mean temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "A")
p2 <- ggplot(dat, aes(code, max_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "B")
p3 <- ggplot(dat, aes(code, min_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "C")
# Multiplot
multiplot(p1, p2, p3, cols = 3)
dat <- read.csv("./output/temp_daily_species.csv", header = TRUE)
head(dat)
dat$day <- as.Date(dat$day)
# Mean temperatures
ggplot(dat, aes(day, mean_tempC)) +
geom_line() +
ylab("Temperature (C)") + xlab("Date") +
facet_wrap(~ code) + theme(legend.position = "none")
# Max temperatures
ggplot(dat, aes(day, max_tempC)) +
geom_line() +
ylab("Temperature (C)") + xlab("Date") +
facet_wrap(~ code) + theme(legend.position = "none")
# Min temperatures
ggplot(dat, aes(day, min_tempC)) +
geom_line() +
ylab("Temperature (C)") + xlab("Date") +
facet_wrap(~ code) + theme(legend.position = "none")
# Relevel the species codes
dat$code <- factor(dat$code, levels = rev(c('LIKE', 'LODI', 'CHFU')),
ordered = TRUE)
# Figure out how many daily records per species, and mean tidal height
dat %>% group_by(code) %>% summarise(totalN = n(),
meanHT = mean(tidalHT, na.rm = TRUE),
sdHT = sd(tidalHT, na.rm = TRUE))
### Violin plot
ggplot(dat, aes(code, mean_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab("Temperature (C)") + xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("", labels = c("CHFU" = "Chlorostoma funebralis\nn=344",
"LODI" = "Lottia digitalis\nn=258",
"LIKE" = "Littorina keenae\nn=344")) +
coord_flip()
ggsave("./figs/temp_violin_spp.pdf", width = 3.5, height = 3.5)
### 3 panel plot
# Relevel the species codes
dat$code <- factor(dat$code, levels = c('LIKE', 'LODI', 'CHFU'),
ordered = TRUE)
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(dat, aes(code, mean_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily mean temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "A")
p2 <- ggplot(dat, aes(code, max_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "B")
p3 <- ggplot(dat, aes(code, min_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "C")
# Multiplot
multiplot(p1, p2, p3, cols = 3)
# save as pdf
pdf("./figs/temp_spp_3panel.pdf", width = 3.5, height = 7)
multiplot(p1, p2, p3, cols = 1)
dev.off()
# Relevel the species codes
dat$code <- factor(dat$code, levels = c('LIKE', 'LODI', 'CHFU'),
ordered = TRUE)
ULClabel <- theme(plot.title = element_text(hjust = -0.05, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(dat, aes(code, mean_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily mean temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "A")
p2 <- ggplot(dat, aes(code, max_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "B")
p3 <- ggplot(dat, aes(code, min_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
xlab("Species") +
theme(legend.position = "none") +
scale_x_discrete("",
labels = c("CHFU" = expression(italic(Chlorostoma)),
"LODI" = expression(italic(Lottia)),
"LIKE" = expression(italic(Littorina)))) +
ULClabel + labs(title = "C")
# Multiplot
multiplot(p1, p2, p3, cols = 3)
# save as pdf
pdf("./figs/temp_spp_3panel.pdf", width = 3.5, height = 7)
multiplot(p1, p2, p3, cols = 1)
dev.off()
p2 <- ggplot(lit, aes(max_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p2
p3 <- ggplot(lit, aes(min_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p3
multiplot(p1, p1, p1, cols = 3)
# Plot Littorina data separately for each tidal height
dat <- read.csv("./output/temp_daily_species.csv", header = TRUE)
str(dat$code)
lit <- dat %>% filter(code == "LIKE") %>% droplevels()
levels(lit$nest1)
names(lit)
unique(lit$nest2)
ggplot(lit, aes(nest2, mean_tempC)) +
geom_violin(fill = "gray") +
geom_boxplot(width = 0.3, notch = TRUE, color = "black") +
ylab(expression(paste("Daily mean temperature (", degree, "C)"))) +
facet_wrap(~ nest1, nrow = 4)
names(lit)
ggplot(lit, aes(mean_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
facet_wrap(~ nest2, nrow = 4)
ggplot(lit, aes(max_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
facet_wrap(~ nest2, nrow = 4)
ggplot(lit, aes(min_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
facet_wrap(~ nest2, nrow = 4)
###
# Ignore crack/face
ggplot(lit, aes(mean_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)")))
ggplot(lit, aes(max_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily max temperature (", degree, "C)")))
ggplot(lit, aes(min_tempC, fill = nest1)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily min temperature (", degree, "C)")))
###
# Facets as zone
# rename and relevel the zones
# what is the average tidal height?
lit %>% group_by(nest1) %>% summarise(totalN = n(),
meanHT = mean(tidalHT, na.rm = TRUE),
sdHT = sd(tidalHT, na.rm = TRUE))
# create new factor column
factorList <- unique(lit$nest1)
factorList
factorList2 <- rev(c("7.2m", "6.0m", "3.9m", "2.8m"))
factorList2
lit$zone <- mapvalues(lit$nest1, from = factorList, to = factorList2)
levels(lit$zone)
lit$zone <- factor(lit$zone, levels = c('7.2m', '6.0m', '3.9m', '2.8m'),
ordered = TRUE)
lit$nest1 <- factor(lit$nest1, levels = c('D', 'C', 'B', 'A'),
ordered = TRUE)
### 3 panel plot
ULClabel <- theme(plot.title = element_text(hjust = -0.1, vjust = 1,
size = rel(1.2)))
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p1
p2 <- ggplot(lit, aes(max_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p2
p3 <- ggplot(lit, aes(min_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p3
multiplot(p1, p1, p1, cols = 3)
pdf("./figs/childs_temp.pdf", width = 7, height = 7)
multiplot(p1, p2, p3, cols = 3)
dev.off()
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A")
p1
p2 <- ggplot(lit, aes(max_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "B")
p2
p3 <- ggplot(lit, aes(min_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "C")
p3
# save as pdf
pdf("./figs/childs_temp.pdf", width = 7, height = 7)
multiplot(p1, p2, p3, cols = 3)
dev.off()
p1 <- ggplot(lit, aes(mean_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily mean temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "A") +
scale_x_continuous(limits = c(10, 45))
p1
p2 <- ggplot(lit, aes(max_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily maximum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "B") +
scale_x_continuous(limits = c(10, 45))
p2
p3 <- ggplot(lit, aes(min_tempC, fill = nest2)) +
geom_density(alpha = 0.5) +
xlab(expression(paste("Daily minimum temperature (", degree, "C)"))) +
ylab("Probability density") +
scale_fill_manual(breaks = c("Crack", "Face"),
values = c("blue", "red")) +
theme(legend.position = "none") +
facet_wrap(~ zone, nrow = 4) +
ULClabel + labs(title = "C") +
scale_x_continuous(limits = c(10, 45))
p3
# save as pdf
pdf("./figs/childs_temp.pdf", width = 7, height = 7)
multiplot(p1, p2, p3, cols = 3)
dev.off()
