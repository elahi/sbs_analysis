geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
theme(legend.justification = c(1, 0), legend.position = c(1, 0)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE)
lmerDat %>%
ggplot(aes(delta_C, delta_size_per, color = species, shape = study)) +
theme_bw(base_size = 10) +
geom_point(alpha = 0.5, size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
# theme(legend.justification = c(1, 0), legend.position = c(1, 0)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE)
# geom_line(aes(color = NULL, shape = NULL), data = newdat)
ggsave("sbs_meta/meta_figs/deltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
lmerDat %>%
ggplot(aes(delta_C, delta_size_per, color = species, shape = study)) +
theme_bw(base_size = 10) +
geom_point(alpha = 0.5, size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
theme(legend.justification = c(1, 0), legend.position = c(1, 0)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE)
# geom_line(aes(color = NULL, shape = NULL), data = newdat)
ggsave("sbs_meta/meta_figs/deltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per))
# Get average size change
lmerDat2 <- lmerDat %>%
group_by(study, species) %>%
summarise(mean_delta_size_per = mean(delta_size_per),
sd_delta_size_per = sd(delta_size_per),
n_delta_size_per = n(),
delta_C = mean(delta_C))
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per))
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(1, 0), legend.position = c(1, 0)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(1, 0), legend.position = c(1, 0)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(1, 0), legend.position = c(0, 1)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(0, 1), legend.position = c(0, 1)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
ggsave("sbs_meta/meta_figs/meanDeltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
theme_bw(base_size = 10) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(0, 1), legend.position = c(0, 1)) +
theme(legend.key.size = unit(0.2, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
ggsave("sbs_meta/meta_figs/meanDeltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
theme_bw(base_size = 10) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(0, 1), legend.position = c(0, 1)) +
theme(legend.key.size = unit(0.1, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
ggsave("sbs_meta/meta_figs/meanDeltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
lmerDat2 %>%
ggplot(aes(delta_C, mean_delta_size_per, color = species, shape = study)) +
theme_bw(base_size = 10) +
geom_point(aes(size = n_delta_size_per)) +
scale_size_continuous(range = c(3,6)) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
geom_vline(xintercept = 0, linetype = "dashed", color = "gray") +
labs(x = "Change in mean annual temperature (C)", y = "Change in size (%)") +
geom_errorbar(aes(ymin = mean_delta_size_per - sd_delta_size_per,
ymax = mean_delta_size_per +  sd_delta_size_per)) +
theme(legend.justification = c(0, 1), legend.position = c(0, 1)) +
theme(legend.key.size = unit(0.3, "cm"), legend.title = element_blank()) +
guides(shape = FALSE, size = FALSE)
ggsave("sbs_meta/meta_figs/meanDeltaSizePer_v_meanDeltaC.png", height = 3.5, width = 3.5)
head(dfHad)
had_hms <- dfHad %>% filter(study == "Elahi2015")
hms_raw <- read.table("http://mlo.stanford.edu/HMS-SST.txt",
header = TRUE, na.strings = "NaN")
head(hms_raw)
hms_raw <- read.table("./data/HMS-SST.txt",
skip = 0, header = TRUE, na.strings = "NaN",
stringsAsFactors = FALSE)
hms_raw
hms_raw <- read.table("./data/HMS-SST.txt",
skip = 0, header = TRUE, na.strings = "NaN",
stringsAsFactors = FALSE)
# Get corrected temperature data (up to 2004)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
head(hms_raw)
head(hms_corr)
str(hms_raw)
hms_raw$dateR <- as.Date(hms_raw$DATE, "%m/%d/%Y")
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
str(hms_corr)
dat1 <- hms_raw %>% select(dateR, SST)
dat2 <- hms_corr %>% select(dateR, new) %>% rename(SST = new)
# Get uncorrected data for 2005 on
str(dat1$dateR)
dat3 <- dat1 %>% filter(dateR > "2004-12-31")
head(dat3)
# now combine corrected and uncorrected data
master <- rbind(dat2, dat3)
head(master)
# get month and year to calculate averages
master$month <- strftime(master$dateR, "%m")
master$year <- strftime(master$dateR, "%Y")
master$mo_yr <- with(master, paste(month, year, sep = "_"))
master$SST <- as.numeric(master$SST)
str(master)
# this value is suspicious
min(master$SST, na.rm = TRUE)
master %>% filter(SST < 8)
master2 <- master %>% filter(SST < 7.3)
master2
# Quick plot
head(master)
ggplot(data = master, aes(dateR, SST)) +
geom_line()
# Quick plot (1944 - 2014)
master %>% filter(year > 1943 & year < 2015) %>%
ggplot(aes(dateR, SST)) +
geom_point() + geom_line() +
geom_smooth(method = "lm") +
ggtitle("Annual Sea Surface Temperature\n1944 - 2014") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.position = "none")
ggsave("./figs/hms_sst_daily.pdf", width = 3.5, height = 3.5)
hms_raw <- read.table("http://mlo.stanford.edu/HMS-SST.txt",
header = TRUE, na.strings = "NaN")
head(hms_raw)
hms_raw <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1970-01-01"))
head(hms_raw)
hms_raw <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1899-12-30"))
head(hms_raw)
hms_raw <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1899-12-30"),
year = ymd(dateR))
hms_raw
head(hms_raw)
hms_raw <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1899-12-30"),
year = year(dateR))
head(hms_raw)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
head(hms_raw)
head(hms_corr)
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
str(hms_corr)
head(hms_corr)
tail(hms_corr)
head(hms_raw)
hms_raw <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1899-12-30"),
year = year(dateR)) %>%
rename(time = TIME_COL, tempC = SST) %>%
select(dateR, year, time, tempC)
head(hms_raw)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
head(hms_corr)
hms_corr <- hms_corr %>%
rename(tempC = new) %>% select(dateR, year, time, tempC)
hms_corr <- hms_corr %>%
rename(tempC = new) %>% select(dateR, year, time, tempC) %>%
filter(tempC < 2005)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
head(hms_corr)
hms_corr2 <- hms_corr %>%
rename(tempC = new) %>% select(dateR, year, time, tempC) %>%
filter(tempC < 2005)
hms_corr2 <- hms_corr %>%
rename(tempC = new) %>% select(dateR, year, time, tempC) %>%
filter(year < 2005)
hms_corr <- read.table("./data/HMStemp.corrected.txt",
skip = 13, header = TRUE, na.strings = "NaN")
hms_corr$dateR <- as.Date(with(hms_corr, ISOdate(year, month, day)))
head(hms_corr)
hms_corr2 <- hms_corr %>%
rename(tempC = new) %>% select(dateR, year, time, tempC) %>%
filter(year < 2005)
hms_raw <- read.table("http://mlo.stanford.edu/HMS-SST.txt",
header = TRUE, na.strings = "NaN")
head(hms_raw)
hms_raw2 <- hms_raw %>%
mutate(dateR = as.Date(DATE, origin = "1899-12-30"),
year = year(dateR)) %>%
rename(time = TIME_COL, tempC = SST) %>%
select(dateR, year, time, tempC)
hms_raw3 <- hms_raw2 %>% filter(year > 2004)
sst_hms <- rbind(hms_corr2, hms_raw3)
tail(sst_hms)
head(dfHad)
sst_hms
head(sst_hms)
head(had_hms)
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
mutate(Month = lubridate::month(Date))
had_hms2
head(sst_hms)
sst_hms <- rbind(hms_corr2, hms_raw3) %>%
mutate(Month = lubridate::month(dateR))
tail(sst_hms)
sst_hms <- rbind(hms_corr2, hms_raw3) %>%
mutate(Month = lubridate::month(dateR))
tail(sst_hms)
head(sst_hms)
sst_hms2 %>% group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE))
sst_hms2 <- sst_hms %>% group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE))
warnings()
glimpse(sst_hms)
glimps(hms_raw)
glimpse(hms_raw)
sort(unique(hms_raw$SST))
hms_raw2 <- hms_raw %>% filter(SST == "18U")
sst <- as.numeric(hms_raw2$SST)
summary(sst)
hms_raw2 <- hms_raw %>% filter(SST != "18U")
hms_raw2 <- hms_raw %>% filter(SST == "18U")
View(hms_raw2)
sst <- as.numeric(sst_hms2$tempC)
sst_hms2 <- sst_hms %>%
mutate(tempC = as.numeric(tempC)) %>%
group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE))
sst_hms2 <- sst_hms %>%
mutate(tempC = as.numeric(tempC)) %>%
group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE)) %>%
ungroup()
sst_hms2
sst_hms2 <- sst_hms %>%
mutate(tempC = as.numeric(tempC)) %>%
group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE)) %>%
ungroup() %>%
mutate(tempSource = "hms_sst")
sst_hms2
head(had_hms)
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
mutate(Month = lubridate::month(Date))
had_hms2
head(had_hms2)
sst_hms2
sst_hms <- rbind(hms_corr2, hms_raw3) %>%
mutate(month = lubridate::month(dateR))
tail(sst_hms)
##### COMBINE SST WITH HAD #####
head(sst_hms)
glimpse(sst_hms)
sst_hms2 <- sst_hms %>%
mutate(tempC = as.numeric(tempC)) %>%
group_by(year, Month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE)) %>%
ungroup() %>%
mutate(tempSource = "hms_sst")
sst_hms2
sst_hms2 <- sst_hms %>%
mutate(tempC = as.numeric(tempC)) %>%
group_by(year, month) %>%
summarise(tempC = mean(tempC, na.rm = TRUE)) %>%
ungroup() %>%
mutate(tempSource = "hms_sst")
sst_hms2
head(had_hms)
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
rename(year = Year, tempC = Temperature_C)
mutate(month = lubridate::month(Date),
tempSource = "had_sst")
head(had_hms2)
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
rename(year = Year, tempC = Temperature_C)
mutate(month = lubridate::month(Date),
tempSource = "had_sst")
had_hms
head(had_hms)
ad_hms %>% select(Date, Temperature_C, Year)
had_hms %>% select(Date, Temperature_C, Year) %>%
rename(year = Year, tempC = Temperature_C)
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
rename(year = Year, tempC = Temperature_C) %>%
mutate(month = lubridate::month(Date),
tempSource = "had_sst")
head(had_hms2)
sst_hms2
had_hms2 <- had_hms %>% select(Date, Temperature_C, Year) %>%
rename(year = Year, tempC = Temperature_C) %>%
mutate(month = lubridate::month(Date),
tempSource = "had_sst") %>%
select(-Date)
head(had_hms2)
sst_hms2
sstDat <- rbind(sst_hms2, had_hms2)
sstDat <- sstDat %>%
mutate(dateR = as.Date(ISOdate(year, month, 1)))
sstDat
sstDat <- sstDat %>%
mutate(dateR = as.Date(ISOdate(year, month, 15)))
sstDat
sstDat %>%
ggplot(aes(dateR, tempC, color = tempSource)) +
geom_line()
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runMean(tempC, 12))
library(caTools)
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runMean(tempC, 12))
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runmean(tempC, 12))
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line()
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)")
sstDat2 %>% filter(year > 1919) %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)")
ggsave("sbs_meta/meta_figs/sst_comparison_v_time.png")
sstDat2 %>% filter(year > 1919)
sstDat2 %>% filter(year > 1919) %>%
spread(key = tempSource, value = tempC)
sstDat2 %>% filter(year > 1919) %>%
spread(key = tempSource, value = runMean)
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runmean(tempC, 12)) %>% ungroup()
sstDat2 %>% filter(year > 1919) %>%
spread(key = tempSource, value = runMean)
sstDat2
sstDat2
sstDat2 %>% filter(year > 1919) %>%
spread(key = tempSource, value = runMean)
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runmean(tempC, 12)) %>% ungroup()
sstDat2
sstDat2 <- sstDat %>% group_by(tempSource) %>%
mutate(runMean = runmean(tempC, 12)) %>% ungroup() %>%
filter(year > 1919)
sstDat2 %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)")
sstDat2 %>%
spread(key = tempSource, value = runMean)
sstDat2
sstDat2 %>% select(tempSource, dateR, runMean) %>%
spread(key = tempSource, value = runMean)
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean)
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth() +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)")
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)")
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)")
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)")
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)") +
facet_wrap(~ as.factor(month), ncol = 3)
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)") +
facet_wrap(~ as.factor(month))
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0) +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)") +
facet_wrap(~ month)
sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean) %>%
ggplot(aes(had_sst, hms_sst)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
geom_abline(slope = 1, intercept = 0, linetype = "dashed", color = "gray") +
labs(x = "SST-HADI (C)", y = "SST-HMS (C)") +
facet_wrap(~ month)
sstDatW <- sstDat2 %>% select(tempSource, dateR, runMean, month) %>%
spread(key = tempSource, value = runMean)
ggsave("sbs_meta/meta_figs/had_v_hms_sst.png")
ggsave("sbs_meta/meta_figs/had_v_hms_sst.png", height = 7, width = 7)
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)") +
theme(legend.position = c(0, 1), legend.justification = c(0, 1))
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature, C (12-month running mean)") +
theme(legend.position = c(0, 1), legend.justification = c(0, 1)) +
theme(legend.title = element_blank())
sstDat2 %>%
ggplot(aes(dateR, runMean, color = tempSource)) +
geom_line() +
labs(x = "", y = "Temperature (C)\n(12-month running mean)") +
theme(legend.position = c(0, 1), legend.justification = c(0, 1)) +
theme(legend.title = element_blank())
ggsave("sbs_meta/meta_figs/sst_comparison_v_time.png", height = 3.5, width = 5)
View(had_hms2)
