geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(1, 1), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.5), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
#facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
guides(shape = FALSE) +
theme(legend.position = c(0.5, 1), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
guides(shape = FALSE) +
theme(legend.position = c(0.5, 1), legend.justification = c(0.5, 0.5)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
guides(shape = FALSE) +
theme(legend.position = c(0.5, 1), legend.justification = c(0.5, 1)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
guides(shape = FALSE) +
theme(legend.position = c(0.5, 1), legend.justification = c(0.5, 1)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 3.5)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.5, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.5) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
guides(shape = FALSE) +
theme(legend.position = c(0.5, 1), legend.justification = c(0.5, 1)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 3.5)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
#facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.8, size = 3) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.8) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) + geom_line() +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) + geom_line(group = sampleArea) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(aes(group = sampleArea)) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(aes(group = sampleArea), color = "gray", linetype = "dashed") +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(aes(group = sampleArea), color = "black", size = 0.5) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
geom_line(aes(group = sampleArea), color = "black", size = 0.1) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dodge <- position_dodge(0.1)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2, position = dodge) +
geom_line(aes(group = sampleArea), color = "gray", size = 0.5) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6,
position = dodge) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2, position = dodge) +
geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6,
position = dodge) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
# geom_point(alpha = 0.6, size = 2, position = dodge) +
geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6,
position = dodge) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2, position = dodge) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6,
position = dodge) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_max, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
datSub <- dm2 %>% filter(studySub == "subset") %>%
select(-c(size_se:size_CI, studySub))
datSub
# Get in wide format
datSubW <- datSub %>% group_by(species, sampleArea) %>%
mutate(size_mean2 = lead(size_mean),
size_max2 = lead(size_max)) %>%
ungroup() %>% filter(!is.na(size_mean2)) %>%
select(-c(era, year))
datSubW
datSubW2 <- datSubW %>%
mutate(delta_mean = size_mean2 - size_mean,
delta_mean_per = delta_mean/size_mean * 100,
delta_max = size_max2 - size_max,
delta_max_per = delta_max/size_max * 100)
datSubW2 %>%
ggplot(aes(tidalHeight, delta_mean_per, color = species)) +
geom_point(alpha = 0.5, size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") # +
geom_smooth(method = "lm")
datSubW2 %>%
ggplot(aes(tidalHeight, delta_max_per, color = species)) +
geom_point(alpha = 0.5, size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") # +
geom_smooth(aes(color = NULL), method = "lm")
datSubW2 %>%
ggplot(aes(tidalHeight, delta_mean_per, color = species)) +
geom_point(alpha = 0.5, size = 3) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") # +
geom_smooth(method = "lm")
summary(waraPres)
library(grid)
# plotting functions
source("./R/multiplotF.R")
head(dat4)
##### TRY FACETTING #####
facet_panels <- dat4 %>% select(species, era) %>% distinct() %>%
arrange(species, era)
facet_panels
facet_panels <- facet_panels %>%
mutate(facet_labels = paste(LETTERS)[1:6]) %>%
arrange(facet_labels)
dat6 <- dat4 %>%
inner_join(., facet_panels, by = c("species", "era"))
dat6 %>%
ggplot(aes(size1mm)) +
geom_histogram(aes(y = ..density.. * 100), binwidth = 1,
color = "black", fill = "gray") +
facet_grid(era ~ species, switch = "y") +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red") +
labs(x = "Size (mm)", y = "Frequency (%)") +
theme(strip.background = element_blank()) +
geom_text(data = facet_panels, aes(0.1, 18, label = facet_labels),
inherit.aes = FALSE)
ggsave("figs/sbs_fig1.png", height = 3.5, width = 7)
##### OLD WAY #####
## Make separate dataframes
# Littorina keenae
childsDF <- droplevels(filter(dat6, sp == "LIKE"))
childsPast <- childsDF %>% filter(era == "past")
childsPres <- childsDF %>% filter(era == "present")
# Chlorostoma funebralis
waraDF <- droplevels(filter(dat6, sp == "CHFU"))
waraPast <- waraDF %>% filter(era == "past")
waraPres <- waraDF %>% filter(era == "present")
# Lottia digitalis
hexDF <- droplevels(filter(dat6, sp == "LODI"))
hexPast <- hexDF %>% filter(era == "past")
hexPres <- hexDF %>% filter(era == "present")
## Plot
range(childsPres$tideHTm, na.rm = TRUE)
range(waraPres$tideHTm, na.rm = TRUE)
range(hexPres$tideHTm, na.rm = TRUE)
ULClabel <- theme(plot.title = element_text(hjust = -0.08, vjust = 1,
size = rel(1)))
theme_set(theme_bw(base_size = 8))
no_legend <- theme(legend.position = "none")
fig1e <- ggplot(childsPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Littorina keenae\n1947\nn = 682",
x = 18, y = 0.16, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
fig1f <- ggplot(childsPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Littorina keenae\n2014\nn = 733",
x = 18, y = 0.16, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Lottia digitalis\n1950\nn = 492",
x = 20, y = 0.15, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.20)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Lottia digitalis\n2015\nn = 587",
x = 20, y = 0.15, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
fig1a <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "a") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
summary(waraPres)
fig1b <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
###############################
# save as 7 x 3.5 png
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
fig1a <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Proportion") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2) +
geom_vline(aes(xintercept = size0.05), linetype = "dashed", color = "red")
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
geom_smooth(data = subset(., species == "Littorina keenae"),
aes(tidalHeight, size_mean, color = era))
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
geom_smooth(data = subset(dm2, species == "Littorina keenae"),
aes(tidalHeight, size_mean, color = era))
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
geom_smooth(data = subset(dm2, species == "Littorina keenae"),
aes(tidalHeight, size_mean, color = era),
method = "lm")
dm2 %>% filter(studySub == "subset") %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
labs(x = "Tidal height (m)", y = "Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggsave("figs/elahi_size_era_tidal.png", height = 3.5, width = 7)
