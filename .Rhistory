theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
labs(x = "Latitude", y = "Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 1,
"Littorina keenae" = 3))
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
labs(x = "Latitude", y = "Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = "a",
"Littorina keenae" = "c"))
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
labs(x = "Latitude", y = "Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 6,
"Littorina keenae" = 5))
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
labs(x = "Latitude", y = "Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15))
ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
# geom_smooth(method = "lm", se = TRUE,  aes(color = NULL, shape = NULL),
#             color = "black") +
# geom_smooth(method = "lm", se = FALSE) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +   # theme(legend.position = "top") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey()
ggsave("figs/elahi_pres_meansize_maxtemp.png", height = 3.5, width = 3.5)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15))
ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
# geom_smooth(method = "lm", se = TRUE,  aes(color = NULL, shape = NULL),
#             color = "black") +
# geom_smooth(method = "lm", se = FALSE) +
labs(x = "Maximum temperature (C)", y = "Size (mm)") +
# theme(legend.position = "top") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey()
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15))
p1
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey()
p1
source("R/multiplotF.R")
library(grid)
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15))
range(ggDat$size_mean)
range(ggDat$mean)
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotate("text", label = "A",
x = 17.7, y = 18.5, vjust = 1, hjust = -0.05)
p1
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotate("text", label = "A",
x = 17.7, y = 18.5, vjust = 0, hjust = 0)
p1
ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotate("text", label = "A",
x = 17.7, y = 18.5, vjust = 1, hjust = 1)
ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotate("text", label = "A",
x = 17.7, y = 18.5, vjust = 0, hjust = 1)
facet_A <- grobTREE(textGrob("A"), x = 0.1, y = 0.95,
hjust = 0)
library(grid)
facet_A <- grobTREE(textGrob("A"), x = 0.1, y = 0.95,
hjust = 0)
facet_A <- grobTree(textGrob("A"), x = 0.1, y = 0.95,
hjust = 0)
facet_A <- grobTree(textGrob("A", x = 0.1, y = 0.95, hjust = 0))
ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotation_custom(facet_A)
facet_A <- grobTree(textGrob("A", x = 0.05, y = 0.95, hjust = 0))
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotation_custom(facet_A)
p1
facet_A <- grobTree(textGrob("A", x = 0.05, y = 0.95, hjust = 0.5))
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotation_custom(facet_A)
p1
facet_B <- grobTree(textGrob("B", x = 0.05, y = 0.95, hjust = 0.5))
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B)
p2
png("./figs/spatial_temp_size.png", width = 7, height = 3.5, units = "in", res = 300)
multiplot(p1, p2, cols = 2)
dev.off()
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B)
p2
facet_A <- grobTree(textGrob("A", x = 0.05, y = 0.95, hjust = 1))
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotation_custom(facet_A)
p1
facet_A <- grobTree(textGrob("A", x = 0.1, y = 0.95, hjust = 0.5))
p1 <- ggDat %>%
ggplot(aes(mean, size_mean, color = species,
shape = species, size = NULL)) +
geom_point(alpha = 0.75, size = 2) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI,
size = NULL), width = 0.5, alpha = 0.75) +
geom_errorbarh(aes(xmax = mean + CI,
xmin = mean - CI,
size = NULL), height = 0.5, alpha = 0.75) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
annotation_custom(facet_A)
p1
facet_B <- grobTree(textGrob("B", x = 0.05, y = 0.95, hjust = 0.5))
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B)
p2
png("./figs/spatial_temp_size.png", width = 7, height = 3.5, units = "in", res = 300)
multiplot(p1, p2, cols = 2)
dev.off()
View(lat_grad_df)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_hline(xintercept = 36.64)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_hline(x_intercept = 36.64)
?geom_vline
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64, alpha = 0.25, size = 4)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64, alpha = 0.1, size = 5)
lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64, alpha = 0.05, size = 8)
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64, alpha = 0.05, size = 8)
p2
png("./figs/spatial_temp_size.png", width = 7, height = 3.5, units = "in", res = 300)
multiplot(p1, p2, cols = 2)
dev.off()
p2 <- lat_grad_df %>%
ggplot(aes(Latitude, size_mm, shape = species, color = species)) +
geom_point(alpha = 0.75, size = 2) +
# geom_smooth(method = "lm") +
scale_x_reverse() +
theme(legend.position = "none") +
#theme(legend.position = c(1,1), legend.justification = c(1,1)) +
theme(legend.title = element_blank(),
legend.text = element_text(face = "italic", size = 8)) +
scale_colour_grey() +
xlab("Latitude") +
ylab("Size (mm)") +
scale_shape_manual(values = c("Chlorostoma funebralis" = 16,
"Littorina keenae" = 15)) +
annotation_custom(facet_B) +
geom_vline(xintercept = 36.64, alpha = 0.05, size = 6)
p2
png("./figs/spatial_temp_size.png", width = 7, height = 3.5, units = "in", res = 300)
multiplot(p1, p2, cols = 2)
dev.off()
install.packages("rtide")
