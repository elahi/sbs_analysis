master <- master %>% mutate(year = lubridate::year(mdy(date)))
names(master)
names(dat3)
dat3 <- dat2 %>%
select(-c(habitat, tideHTm_orig, sample_area_tidal_ht, size_prop, LL))
names(dat3)
ack_past <- ackerman %>%
filter(era == "past")
names(ackerman)
ack_past %>% count(size1mm)
ack_past_histo <- ack_past %>% count(size1mm)
ack_past_size_norm <- get_random_sizes(size_bin_vector = ack_past_histo$size1mm,
count_vector = ack_past_histo$n, size_interval = 1)
# Functions to convert histogram data to vector of raw sizes
source("R/convert_histo_to_raw.R")
ack_past_size_norm <- get_random_sizes(size_bin_vector = ack_past_histo$size1mm,
count_vector = ack_past_histo$n, size_interval = 1)
ack_past_size_norm
plot(ack_past$size1mm, ack_past_size_norm)
get_random_sizes
ackerman$size1mm_norm <- ack_past_size_norm
ack_past$size1mm_norm <- ack_past_size_norm
names(dat3)
ack_pres <- ackerman %>% filter(era == "present")
ack_pres <- ackerman %>% filter(era == "present") %>%
mutate(size1mm_norm = size1mm)
ackerman2 <- rbind(ack_pres, ack_past)
ackerman2
# Get past sizes
frank_past_bins <- c(3.5, 10.5, 17.5, 24.5, 31.5)
frank_past_n <- c(33, 20, 431, 446, 1)
min(frank_present$size1mm)
frank_past_size_vector <- get_random_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n, size_interval = 3.5)
frank_past_size_vector
hist(frank_past_size_vector)
hist(frank_past_size_vector, breaks = 10)
hist(frank_past_size_vector, breaks = 5)
hist(frank_past_size_vector, breaks = 4)
hist(frank_past_size_vector, breaks = 5)
frank_past_size_vector <- get_random_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n, size_interval = 3.5)
hist(frank_past_size_vector, breaks = 5)
unique(frank$Date)
frank_present <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "past",
date = "5/1/1968",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = round(frank_past_size_vector, 1),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "",
notes2 = ""
)
frank_present
frank_present <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "past",
date = "5/1/1968",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = round(frank_past_size_vector, 1),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "day-month is unknown",
notes2 = ""
)
##### Load Galloway data #####
frank <- read_csv("sbs_meta/scraped/Galloway_2017/SouthCove_Tegula-Size-Counts_Spring2017_AG-Shared_2017-10-13_size.csv") # snail size
frank_counts <- read_csv("sbs_meta/scraped/Galloway_2017/SouthCove_Tegula-Size-Counts_Spring2017_AG-Shared_2017-10-13_counts.csv")
frank <- frank_counts %>%
select(SampleID, Density.m2, Elevation.above.MLLW) %>%
left_join(frank, ., by = "SampleID")
summary(frank)
frank_transects <- frank %>% distinct(`Transect#`) %>%
mutate(lat = c("43.301949N", "43.302368N", "43.302711N", "43.303055N"),
long = c("124.39942W", "124.399239W", "124.399057W", "124.398942W"))
frank <- left_join(frank, frank_transects, by = "Transect#")
frank_present <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "present",
date = frank$Date,
nest1 = frank$`Transect#`,
nest2 = frank$`Sample#`,
nest3 = NA,
nest3note = NA,
sampleUnit = frank$SampleID,
size1mm = round(frank$Width.mm, 1),
habitat = NA,
tideHTm = frank$Elevation.above.MLLW,
lat = frank$lat,
long = frank$long,
Shaw_hab = NA,
notes = "",
notes2 = ""
)
head(frank_present)
unique(frank_present$date)
# Get past sizes
frank_past_bins <- c(3.5, 10.5, 17.5, 24.5, 31.5)
frank_past_n <- c(33, 20, 431, 446, 1)
frank_past_size_vector <- get_random_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n, size_interval = 3.5)
hist(frank_past_size_vector, breaks = 5)
frank_past <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "past",
date = "5/1/1968",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = round(frank_past_size_vector, 1),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "day-month is unknown",
notes2 = ""
)
frank2 <- rbind(frank_present, frank_past)
master <- rbind(ackerman, frank_present)
frank2
frank2 %>% count(era)
master <- rbind(ackerman2, frank2)
names(frank2)
names(ackerman2)
frank_past_size <- repeat_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n)
frank_past_size
frank_past_size_norm <- get_random_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n, size_interval = 3.5)
hist(frank_past_size, breaks = 5)
hist(frank_past_size_norm, breaks = 5)
frank_present <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "present",
date = frank$Date,
nest1 = frank$`Transect#`,
nest2 = frank$`Sample#`,
nest3 = NA,
nest3note = NA,
sampleUnit = frank$SampleID,
size1mm = round(frank$Width.mm, 1),
size1mm_norm = round(frank$Width.mm, 1),
habitat = NA,
tideHTm = frank$Elevation.above.MLLW,
lat = frank$lat,
long = frank$long,
Shaw_hab = NA,
notes = "",
notes2 = ""
)
head(frank_present)
unique(frank_present$date)
# Get past sizes
frank_past_bins <- c(3.5, 10.5, 17.5, 24.5, 31.5)
frank_past_n <- c(33, 20, 431, 446, 1)
frank_past_size <- repeat_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n)
frank_past_size_norm <- get_random_sizes(size_bin_vector = frank_past_bins,
count_vector = frank_past_n, size_interval = 3.5)
hist(frank_past_size, breaks = 5)
hist(frank_past_size_norm, breaks = 5)
frank_past <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "past",
date = "5/1/1968",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = frank_past_size
size1mm_norm = round(frank_past_size_norm, 1),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "day-month is unknown",
notes2 = ""
)
frank_past <- data.frame(
study = "Galloway",
studySub = NA,
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = "SouthCove",
era = "past",
date = "5/1/1968",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = frank_past_size,
size1mm_norm = round(frank_past_size_norm, 1),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "day-month is unknown",
notes2 = ""
)
frank2 <- rbind(frank_present, frank_past)
frank2 %>% count(era)
with(frank2, plot(size1mm, size1mm_norm))
master <- rbind(ackerman2, frank2)
names(master)
names(dat3)
unique(master$study)
dat3 <- dat2 %>%
select(-c(habitat, tideHTm_orig, sample_area_tidal_ht, size_prop, LL)) %>%
mutate(study = "Elahi2015",
studySub = NA)
names(dat3)
names(master)
master <- master %>%
mutate(year = lubridate::year(mdy(date)),
sampleArea = NA)
names(master)
names(dat3)
names(master)
master <- rbind(ackerman2, frank2)
names(master)
master <- master %>%
mutate(year = lubridate::year(mdy(date)),
sampleArea = NA)
names(master)
master2 <- rbind(master, dat3)
names(master) %in% names(dat3)
names(dat3)
sort(names(dat3))
sort(names(master))
unique(master$habitat)
dat3 <- dat2 %>%
select(-c(habitat, tideHTm_orig, sample_area_tidal_ht, size_prop, LL, Shaw_hab)) %>%
mutate(study = "Elahi2015",
studySub = NA)
names(dat3)
master <- master %>%
mutate(year = lubridate::year(mdy(date)),
sampleArea = NA) %>%
select(-c(habitat, Shaw_hab))
names(master)
master2 <- rbind(master, dat3)
master2 %>%
ggplot(aes(era, size1mm_norm)) +
geom_violin() +
facet_wrap(~ species)
master2 %>%
ggplot(aes(era, size1mm_norm)) +
geom_violin() +
facet_wrap(~ species + study)
master2 %>%
ggplot(aes(era, size1mm)) +
geom_violin() +
facet_wrap(~ species + study)
master2 %>%
ggplot(aes(era, size1mm_norm)) +
geom_violin() +
facet_wrap(~ species + study)
dat <- read.csv("metabolic_consequences/metabolic_data/Paine_Fig1_data.csv")
dat
dat <- read.csv("metabolic_consequences/metabolic_data/Paine_Fig1_data.csv")
dat
library(dplyr)
library(ggplto2)
library(ggplot2)
# Create size data
size_vec <- seq(1, 1000, by = 5)
dat
M
m
m
m()
M()
# Make predictions
resp_df <- data.frame(M = size_vec)
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC)
resp_df
names(resp_df) <- c("M", "tempC")
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
# Create size data
size_vec <- seq(5, 1000, by = 5)
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
dat
resp_df <- dat %>% select(tempC, slope, n) %>%
left_join(resp_df, ., by = "tempC")
resp_df
resp_df <- dat %>% select(tempC, slope, y1, n) %>%
left_join(resp_df, ., by = "tempC")
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
resp_df <- dat %>% select(tempC, slope, y1, n) %>%
left_join(resp_df, ., by = "tempC")
resp_df
resp_df <- resp_df %>%
mutate(resp = y1 * M^slope)
# Plot
resp_df %>%
ggplot(aes(M, resp)) +
geom_line() +
scale_y_log10() + scale_x_log10()
# Plot
resp_df %>%
ggplot(aes(M, resp, color = tempC)) +
geom_line() +
scale_y_log10() + scale_x_log10()
# Plot
resp_df %>%
ggplot(aes(M, resp, color = as.factor(tempC))) +
geom_line() +
scale_y_log10() + scale_x_log10()
# Create size data
size_vec <- c(1, seq(5, 1000, by = 5))
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
resp_df <- dat %>% select(tempC, slope, y1, n) %>%
left_join(resp_df, ., by = "tempC")
resp_df <- resp_df %>%
mutate(resp = y1 * M^slope)
# Plot
resp_df %>%
ggplot(aes(M, resp, color = as.factor(tempC))) +
geom_line() +
scale_y_log10() + scale_x_log10()
resp_df %>% filter(M == 210)
# Paine's q10 value
q10 <- 2.64
# Import data extracted from Figure 1 - Paine 1917 - Ecology
dat <- read.csv("metabolic_consequences/metabolic_data/Paine_Fig1_data.csv")
dat
# Paine's q10 value
q10 <- 2.64
# Create size data
size_vec <- c(1, seq(5, 1000, by = 5))
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
resp_df <- dat %>% select(tempC, slope, y1, n) %>%
left_join(resp_df, ., by = "tempC")
resp_df <- resp_df %>%
mutate(resp = y1 * M^slope)
# Plot
resp_df %>%
ggplot(aes(M, resp, color = as.factor(tempC))) +
geom_line() +
scale_y_log10() + scale_x_log10()
resp_df <- resp_df %>%
mutate(resp = y1 * M^slope,
resp2 = y1 * M^slope_calc)
# Import data extracted from Figure 1 - Paine 1917 - Ecology
dat <- read.csv("metabolic_consequences/metabolic_data/Paine_Fig1_data.csv")
dat
# Make predictions
resp_df <- expand.grid(size_vec, dat$tempC) %>% tbl_df()
names(resp_df) <- c("M", "tempC")
resp_df
resp_df <- dat %>% select(tempC, slope, slope_calc, y1, n) %>%
left_join(resp_df, ., by = "tempC")
resp_df <- resp_df %>%
mutate(resp = y1 * M^slope,
resp2 = y1 * M^slope_calc)
# Plot
resp_df %>%
ggplot(aes(M, resp, color = as.factor(tempC))) +
geom_line() +
scale_y_log10() + scale_x_log10()
# Plot using my calculate slope value (estimated from Figure 1)
resp_df %>%
ggplot(aes(M, resp2, color = as.factor(tempC))) +
geom_line() +
scale_y_log10() + scale_x_log10()
# Average sized individual
mean_weight <- 211 # mg
dat
dat$mean_weight <- mean_weight
Paines_resp <- c(104, 50, 39) # respiration
dat$Paines_resp <- c(104, 50, 39) # respiration
dat
dat <- dat %>%
mutate(mean_resp_calc = y1 * mean_weight^slope_calc)
dat
dat %>%
ggplot(aes(Paines_resp, mean_resp_calc)) +
geom_point() +
geomabline(slope = 0, intercept = 1)
dat %>%
ggplot(aes(Paines_resp, mean_resp_calc)) +
geom_point() +
geom_abline(slope = 0, intercept = 1)
dat %>%
ggplot(aes(Paines_resp, mean_resp_calc)) +
geom_point() +
geom_abline(slope = 1, intercept = 0)
resp_df
# Can I estimate Q10 from my calculated predictions?
dat %>% filter(M == 210)
# Can I estimate Q10 from my calculated predictions?
resp_df %>% filter(M == 210)
respQ10 <- resp_df %>% filter(tempC != 10)
respQ10
respQ10 %>% select(tempC, resp)
respQ10 %>% select(tempC, resp) %>%
spread(key = tempC, value = resp)
library(tidyr)
respQ10 %>% select(tempC, resp) %>%
spread(key = tempC, value = resp)
respQ10
respQ10 %>% select(M, tempC, resp) %>%
spread(key = tempC, value = resp)
respQ10 %>% arrange(desc(tempC))
respQ10 %>% arrange(desc(M))
respQ10 %>% arrange(M
respQ10 %>% arrange(M)
respQ10 %>% arrange(M)
respQ10 %>% select(M, tempC, resp) %>%
spread(key = tempC, value = resp)
# Use my calculated values
respQ10 %>% select(M, tempC, resp_calcu) %>%
spread(key = tempC, value = resp)
# Use my calculated values
respQ10 %>% select(M, tempC, resp_calc) %>%
spread(key = tempC, value = resp)
respQ10
# Use my calculated values
respQ10 %>% select(M, tempC, resp2) %>%
spread(key = tempC, value = resp)
# Use my calculated values
respQ10 %>% select(M, tempC, resp2) %>%
spread(key = tempC, value = resp2)
# Use my calculated values
q10_mine <- respQ10 %>% select(M, tempC, resp2) %>%
spread(key = tempC, value = resp2) %>%
mutate(q10 = `17`/`6.5`)
q10_mine
# Use my calculated values
my_temp_diff = 17-6.5
q10_mine <- respQ10 %>% select(M, tempC, resp2) %>%
spread(key = tempC, value = resp2) %>%
mutate(q10 = (`17`/`6.5`) ^ (10/my_temp_diff))
q10_mine %>%
ggplot(aes(q10)) +
geom_boxplot()
q10_mine %>%
ggplot(aes(q10)) +
geom_density()
View(q10_mine)
# Paine measured q10 between 6.5 and 17C
# Paine's q10 value
q10_paine <- 2.64
q10_mine %>%
ggplot(aes(q10)) +
geom_density() +
geom_vline(xintercept = q10_paine, color = 'red')
q10_mine
q10_mine %>% filter(M == 210)
