unique(mod$notes2)
# quick look at size-frequencies
qplot(size1mm, data = mod, geom = "density",  facets = ~ species, color = site)
qplot(size1mm, data = mod, geom = "histogram",  facets = ~ species, color = site)
# load historic data
childs <- read.csv("./data/childs_raw.csv", na.strings = c("NA", ""))
wara <- read.csv("./data/wara_raw.csv", na.strings = c("NA", ""))
# need to expand these tables
childs
# use package "mirt"
# frequency column needs to be rightmost
library(mirt)
#################################################
# in one line
childsA <- childs %>% select(length_mm, count_A) %>% expand.table()
childsB <- childs %>% select(length_mm, count_B) %>% expand.table()
childsC <- childs %>% select(length_mm, count_C) %>% expand.table()
childsD <- childs %>% select(length_mm, count_D) %>% expand.table()
mod %>% filter(sp == "LIKE") %>% glimpse()
childsPast <- data.frame(size1mm = c(childsA, childsB, childsC, childsD),
nest1 = c(rep("zoneA", length(childsA)),
rep("zoneB", length(childsB)),
rep("zoneC", length(childsC)),
rep("zoneD", length(childsD))))
childsPast
qplot(size1mm, data = childsPast, geom = "density", color = nest1)
qplot(size1mm, data = childsPast, geom = "histogram")
childsPres <- mod %>% filter(sp == "LIKE") %>% select(size1mm, nest1)
childsPast$era <- "1947"
childsPres$era <- "2014"
childsDF <- rbind(childsPast, childsPres)
qplot(size1mm, data = childsDF,  geom = "density", color = era, facets = ~ nest1)
qplot(size1mm, data = childsDF,  geom = "density", color = era)
qplot(size1mm, data = childsDF,  geom = "histogram", facets = ~ era)
qplot(size1mm, data = childsDF[childsDF$nest1 != "zoneD", ],
geom = "density", color = era)
summary(childsDF)
#################################################
### now do Wara
waraB <- wara %>% select(length_mm, count_B) %>% expand.table()
waraD <- wara %>% select(length_mm, count_D) %>% expand.table()
mod %>% filter(sp == "CHFU") %>% glimpse()
waraPast <- data.frame(size1mm = c(waraB, waraD),
site = c(rep("Wara.B", length(waraB)),
rep("Wara.D", length(waraD))))
waraPres <- mod %>% filter(sp == "CHFU") %>% select(size1mm, site)
unique(waraPres$site)
summary(waraPres)
# remove NA's for size
waraPres <- droplevels(waraPres[complete.cases(waraPres$size1mm), ])
waraPast$era <- "1963"
waraPres$era <- "2014"
waraDF <- rbind(waraPast, waraPres)
qplot(size1mm, data = waraDF,  geom = "density", color = era, facets = ~ site)
qplot(size1mm, data = waraDF,  geom = "density", color = era,
xlab = "Size (mm)")
#################################################
hexter <- mod %>% filter(sp == "LODI") %>% select(size1mm, nest1, date, era)
glimpse(hexter)
qplot(size1mm, data = hexter,  geom = "density", color = date,
xlab = "Size (mm)")
qplot(size1mm, data = hexter,  geom = "density", color = era,
xlab = "Size (mm)")
qplot(size1mm, data = hexter,  geom = "density", color = era,
facets = ~ nest1, xlab = "Size (mm)")
qplot(size1mm, data = hexter,  geom = "density", color = era,
facets = site ~ nest1, xlab = "Size (mm)")
glimpse(hexter)
hexter <- mod %>% filter(sp == "LODI") %>% select(size1mm, site, nest1, date, era)
glimpse(hexter)
qplot(size1mm, data = hexter,  geom = "density", color = era,
facets = site ~ nest1, xlab = "Size (mm)")
with(hexter, table(site, nest1, era))
hexter <- droplevels(hexter)
glimpse(hexter)
qplot(size1mm, data = hexter,  geom = "density", color = era,
facets = site ~ nest1, xlab = "Size (mm)")
with(hexter, table(site, nest1, era))
with(hexter, table(era, site, nest1))
with(hexter, table(era, nest1, site))
with(hexter, table(era))
with(hexter, table(era, site))
hexSub <- hexter %>% filter(size1mm > 5.95)
with(hexSub, table(era, nest1, site))
with(hexSub, table(era, site))
qplot(size1mm, data = hexSub,  geom = "density", color = date,
xlab = "Size (mm)")
qplot(size1mm, data = hexSub,  geom = "density", color = era,
xlab = "Size (mm)")
qplot(size1mm, data = hexSub,  geom = "histogram", fill = era,
xlab = "Size (mm)")
summary(hexSub)
hexPast <- hexSub %>% filter(era == "past")
hexPres <- hexSub %>% filter(era == "present")
# Try plotting percentages
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram()
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray")
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray")
ggplot(hexSub, aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..), fill = date))
# KS-tests: overall
ks.test(waraPast$size1mm, waraPres$size1mm)
ks.test(childsPast$size1mm, childsPres$size1mm)
ks.test(hexPast$size1mm, hexPres$size1mm)
ks.test(hexPast$size1mm, hexPres$size1mm)
# Childs data, exclude zoneD
childsSub <- childsDF[childsDF$nest1 != "zoneD", ]
childsSubPast <- childsSub %>%
glimpse(childsSub)
childsSubPres <- childsSub %>% filter(era == "2014")
childsSubPast <- childsSub %>% filter(era == "1947")
ULClabel <- theme(plot.title = element_text(hjust = -0.08, vjust = 1,
size = rel(1)))
no_legend <- theme(legend.position = "none")
axisLabels1 <- xlab("Size (mm)") + ylab("Frequency (%)")
fig1a <- ggplot(childsSubPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "A") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n1947\nn = 650",
x = 18, y = 0.16, size = 2.2)
fig1b <- ggplot(childsSubPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "B") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Littorina keenae\n2014\nn = 683",
x = 18, y = 0.16, size = 2.2)
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray")
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.32)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 104",
x = 17, y = 0.25, size = 2.2)
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.32)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 17, y = 0.25, size = 2.2)
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray")
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 390",
x = 17, y = 0.2, size = 2.2)
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.2)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 17, y = 0.25, size = 2.2)
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 17, y = 0.25, size = 2.2)
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 390",
x = 17, y = 0.2, size = 2.2)
ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 390",
x = 20, y = 0.15, size = 2.2)
ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 20, y = 0.15, size = 2.2)
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 390",
x = 20, y = 0.15, size = 2.2)
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.25)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 20, y = 0.15, size = 2.2)
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Tegula funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Tegula funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
# multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
###############################
# save as 7 x 3.5 pdf
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
fig1c <- ggplot(hexPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.22)) +
labs(title = "C") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n1950\nn = 390",
x = 20, y = 0.15, size = 2.2)
fig1d <- ggplot(hexPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 1,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(5, 25)) +
scale_y_continuous(limits = c(0, 0.22)) +
labs(title = "D") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Lottia digitalis\n2015\nn = 378",
x = 20, y = 0.15, size = 2.2)
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Tegula funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Tegula funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
# multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
###############################
# save as 7 x 3.5 pdf
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
fig1e <- ggplot(waraPast,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "E") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n1963\nn = 817",
x = 25, y = 0.25, size = 2.2)
summary(waraPres)
fig1f <- ggplot(waraPres,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = 2,
color = "black", fill = "gray") +
scale_x_continuous(limits = c(2, 32)) +
scale_y_continuous(limits = c(0, 0.31)) +
labs(title = "F") + ULClabel + xlab("Size (mm)") + ylab("Frequency (%)") +
annotate("text", label = "Chlorostoma funebralis\n2014\nn = 5995",
x = 25, y = 0.25, size = 2.2)
# multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
###############################
# save as 7 x 3.5 pdf
pdf("./figs/sbs_fig1.pdf", 7, 3.5)
multiplot(fig1a, fig1b, fig1c, fig1d, fig1e, fig1f, cols = 3)
dev.off()
rm(list=ls(all=TRUE))
source("./R/multiplotF.R")
# load modern data, along with historic data for Lottia (Hexter)
mod <- read.csv("./data/SBSmaster_150717.csv", na.strings = c("NA", ""))
# load historic data
childs <- read.csv("./data/childs_raw.csv", na.strings = c("NA", ""))
wara <- read.csv("./data/wara_raw.csv", na.strings = c("NA", ""))
childs
library(mirt)
childsA <- childs %>% select(length_mm, count_A) %>% expand.table()
childsB <- childs %>% select(length_mm, count_B) %>% expand.table()
childsC <- childs %>% select(length_mm, count_C) %>% expand.table()
childsD <- childs %>% select(length_mm, count_D) %>% expand.table()
mod %>% filter(sp == "LIKE") %>% glimpse()
childsPast <- data.frame(size1mm = c(childsA, childsB, childsC, childsD),
nest1 = c(rep("zoneA", length(childsA)),
rep("zoneB", length(childsB)),
rep("zoneC", length(childsC)),
rep("zoneD", length(childsD))))
childsPast
childsPast
childsPres <- mod %>% filter(sp == "LIKE") %>% select(size1mm, nest1)
childsPast$era <- "past"
childsPres$era <- "present"
childsDF <- rbind(childsPast, childsPres)
qplot(size1mm, data = childsDF,  geom = "density", color = era, facets = ~ nest1)
waraB <- wara %>% select(length_mm, count_B) %>% expand.table()
waraD <- wara %>% select(length_mm, count_D) %>% expand.table()
mod %>% filter(sp == "CHFU") %>% glimpse()
waraPast <- data.frame(size1mm = c(waraB, waraD),
site = c(rep("Wara.B", length(waraB)),
rep("Wara.D", length(waraD))))
waraPres <- mod %>% filter(sp == "CHFU") %>% select(size1mm, site)
unique(waraPres$site)
summary(waraPres)
waraPres <- droplevels(waraPres[complete.cases(waraPres$size1mm), ])
waraPast$era <- "past"
waraPres$era <- "present"
waraDF <- rbind(waraPast, waraPres)
wara
head(childsDF)
head(mod)
childsPres <- mod %>% filter(sp == "LIKE") %>%
select(size1mm, nest1, era, nest1, nest2, tideHTm, lat, long)
childsPast
childsPast <- data.frame(species = "Littorina.keenae",
sp = "LIKE",
site = "HighRock",
era = "past",
date = "6/14/47",
nest1 = c(rep("zoneA", length(childsA)),
rep("zoneB", length(childsB)),
rep("zoneC", length(childsC)),
rep("zoneD", length(childsD))),
nest2 = "area1",
nest3 = NA,
nest3note = NA,
sampleUnit = "",
size1mm = c(childsA, childsB, childsC, childsD),
habitat = "bare rock",
tideHTm = "",
lat = "36.62183N",
long = "121.90516W",
Shaw_hab = NA,
notes = "",
notes2 = ""
)
childsPast
glimpse(childsPast)
glimpse(mod)
rbind(mod, childsPast)
childsPast <- data.frame(row = "",
species = "Littorina.keenae",
sp = "LIKE",
site = "HighRock",
era = "past",
date = "6/14/47",
nest1 = c(rep("zoneA", length(childsA)),
rep("zoneB", length(childsB)),
rep("zoneC", length(childsC)),
rep("zoneD", length(childsD))),
nest2 = "area1",
nest3 = NA,
nest3note = NA,
sampleUnit = "",
size1mm = c(childsA, childsB, childsC, childsD),
habitat = "bare rock",
tideHTm = "",
lat = "36.62183N",
long = "121.90516W",
Shaw_hab = NA,
notes = "",
notes2 = ""
)
glimpse(childsPast)
glimpse(rbind(mod, childsPast))
mod %>% filter(sp == "CHFU") %>% glimpse()
waraPast <- data.frame(row = "",
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = c(rep("Wara.B", length(waraB)),
rep("Wara.D", length(waraD))),
era = "past",
date = "6/1/63",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = c(childsA, childsB, childsC, childsD),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "",
notes2 = ""
)
waraPast <- data.frame(row = "",
species = "Chlorostoma.funebralis",
sp = "CHFU",
site = c(rep("Wara.B", length(waraB)),
rep("Wara.D", length(waraD))),
era = "past",
date = "6/1/63",
nest1 = NA,
nest2 = NA,
nest3 = NA,
nest3note = NA,
sampleUnit = NA,
size1mm = c(waraB, waraD),
habitat = NA,
tideHTm = NA,
lat = NA,
long = NA,
Shaw_hab = NA,
notes = "",
notes2 = ""
)
sbsMaster <- rbind(mod, childsPast, waraPast)
write.csv(sbsMaster, './output/sbsMaster.csv')
dat <- read.csv("./output/sbsMaster.csv", na.strings = c("NA"))
library(dplyr)
chil <- filter(dat, sp = "LIKE")
chil <- filter(dat, sp = "LIKE")
chil <- filter(dat, sp == "LIKE")
summary(chil)
glimpse(sbsMaster)
sbsMaster$row <- length(sbsMaster$sp)
sbsMaster$row <- seq(1:length(sbsMaster$sp))
glimpse(sbsMaster)
write.csv(sbsMaster, './output/sbsMaster.csv')
dat <- read.csv("./output/sbsMaster.csv", na.strings = c("NA"))
chil <- filter(dat, sp == "LIKE")
summary(chil)
library(lme4)
chil <- droplevels(filter(dat, sp == "LIKE"))
summary(chil)
qplot(size1mm, nest1, aes(chil), color = era, geom = "boxplot")
qplot(size1mm, nest1, aes(chil, color = era), geom = "boxplot")
qplot(size1mm, nest1, data = chil, color = era, geom = "boxplot")
qplot(nest1, size1mm, data = chil, color = era, geom = "boxplot")
qplot(nest1, size1mm, data = chil, color = era, geom = "violin")
qplot(nest1, size1mm, data = chil, color = era, geom = "")
qplot(nest1, size1mm, data = chil, color = era)
qplot(nest1, size1mm, data = chil, color = era, geom = "boxplot")
qplot(nest1, size1mm, data = chil, color = era, geom = "boxplot") + coord_flip()
mod1 <- lmer(size1mm ~ era*nest1 + (1|nest2),
data = chil)
mod1
summary(mod1)
anova(mod1)
unique(chil$nest2)
names(chil)
randF <- function(x) return(as.factor(paste(x$era, x$nest1, x$nest2, sep="_")))
rand1 <- randF(chil)
unique(chil$rand1)
chil$rand1 <- randF(chil)
unique(chil$rand1)
mod1 <- lmer(size1mm ~ era*nest1 + (1|rand1),
data = chil)
anova(mod1)
library(lmerTest)
### quick model
mod1 <- lmer(size1mm ~ era*nest1 + (1|rand1),
data = chil)
anova(mod1)
mod1
mod1 <- lm(size1mm ~ era*nest1,
data = chil)
mod1
anova(mod1)
names(chil)
unique(chil$nest2)
randF <- function(x) return(as.factor(paste(x$nest1, x$nest2, sep="_")))
chil$rand1 <- randF(chil)
unique(chil$rand1)
### quick boxplot
qplot(nest1, size1mm, data = chil, color = era, geom = "boxplot") + coord_flip()
### quick model
mod1 <- lmer(size1mm ~ era*nest1 + (1|rand1),
data = chil)
mod1
anova(mod1)
qplot(era, size1mm, data = chil, facets = ~ nest1, geom = "boxplot")
