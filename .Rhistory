guides(size = FALSE)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "lm") +
labs(x = "Temperature (C)", y = "Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
geom_point(aes(mean, size_max))
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "lm") +
labs(x = "Temperature (C)", y = "Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
labs(x = "Temperature (C)", y = "Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
labs(x = "Temperature (C)", y = "Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
theme(strip.background = element_blank())
pres3 %>%
ggplot(aes(mean, size1mm, color = species,
shape = species)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "lm") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab(y = "Size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
theme(legend.title = element_blank())
pres3 %>%
ggplot(aes(mean, size1mm, color = species,
shape = species)) +
geom_point(alpha = 0.25) +
geom_smooth(method = "lm") +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
theme(legend.title = element_blank())
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
# geom_point(data = ggDat_gray, color = "grey70") +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggDat %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
# geom_point(data = ggDat_gray, color = "grey70") +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggDat <- suMeans3 %>% filter(metric != "daily_mean" & metric != "daily_cv")
ggDat %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
# geom_point(data = ggDat_gray, color = "grey70") +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggDat %>%
ggDat <- suMeans3 %>% filter(metric != "daily_mean" & metric != "daily_cv")
ggDat <- suMeans3 %>% filter(metric != "daily_mean" & metric != "daily_cv")
ggDat %>%
ggplot(aes(tidalHeight, size_mean, color = era, shape = species)) +
# geom_point(data = ggDat_gray, color = "grey70") +
geom_point(alpha = 0.6, size = 2) +
#geom_line(aes(group = sampleArea), color = "gray", size = 0.5, position = dodge) +
geom_errorbar(aes(ymax = size_mean + size_CI,
ymin = size_mean - size_CI), width = 0.2, alpha = 0.6) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Size (mm)") +
theme(strip.background = element_blank()) +
facet_wrap(~ species) +
guides(shape = FALSE) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank())
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
labs(x = "Mean temperature (C)", y = "Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
theme(strip.background = element_blank())
ggsave("figs/elahi_pres_medsize_temp.png", height = 3.5, width = 7)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
xlab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
theme(strip.background = element_blank())
ggsave("figs/elahi_pres_medsize_temp.png", height = 3.5, width = 7)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
theme(strip.background = element_blank())
ggsave("figs/elahi_pres_medsize_temp.png", height = 3.5, width = 7)
### MEDIAN SIZE
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric) +
guides(size = FALSE) +
theme(strip.background = element_blank())
ggsave("figs/elahi_pres_medsize_temp.png", height = 3.5, width = 7)
ggDat %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE) +
theme(strip.background = element_blank())
ggsave("figs/elahi_pres_medsize_temp.png", height = 3.5, width = 7)
ggDat %>%
ggplot(aes(mean, size_max, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm") +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Maximum size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
facet_wrap(~ metric, scales = "free") +
guides(size = FALSE)
ggsave("figs/elahi_pres_maxsize_temp.png", height = 3.5, width = 7)
unique(ggDat$position)
unique(ggDat$sampleUnit)
unique(ggDat$position)
unique(ggDat$sampleArea)
ggDat %>% filter(metric == "daily_med") %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2))
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
guides(size = FALSE)
ggDat %>% filter(metric == "daily_med") %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2)) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
guides(size = FALSE)
ggDat %>% filter(metric == "daily_med") %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2)) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
guides(size = FALSE)
ggsave("figs/elahi_pres_medsize_quad_temp.png", height = 3.5, width = 3.5)
ggDat %>% filter(metric == "daily_med") %>%
ggplot(aes(mean, size_max, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2)) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
guides(size = FALSE)
ggDat %>% filter(metric == "daily_med") %>%
ggplot(aes(mean, size_median, color = species,
shape = species, size = size_n)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", formula = y ~ x + I(x^2)) +
xlab(expression(paste("Temperature (", degree, "C)"))) +
ylab("Median size (mm)") +
theme(legend.position = "top") +
theme(legend.title = element_blank()) +
guides(size = FALSE)
ggsave("figs/elahi_pres_medsize_quad_temp.png", height = 3.5, width = 3.5)
source("R/get_hms_sst.R")
# Get hms temperature functions
source("R/hms_sst_functions.R")
glimpse(sst_hms)
# These are mean values of monthly mean, max, and min
glimpse(sst_annual)
sst_monthly <- sst_hms_combined %>% group_by(hmsTemp, year, month) %>%
summarise(monthly_mean = mean(tempC),
monthly_median = median(tempC),
monthly_max = max(tempC),
monthly_min = min(tempC),
monthly_sd = sd(tempC),
monthly_cv = monthly_sd/monthly_mean * 100) %>%
mutate(dateR = ymd(paste(year, month, 15, sep = "-"))) %>%
ungroup()
sst_monthly %>%
ggplot(aes(dateR, monthly_mean, color = hmsTemp)) +
geom_line()
sst_monthly %>%
ggplot(aes(dateR, monthly_median, color = hmsTemp)) +
geom_line()
elahi_sst_monthly <- sst_monthly %>% filter(year > 1937) %>%
filter(hmsTemp == "corrected") %>%
select(-monthly_sd)
elahi_sst <- elahi_sst_monthly %>% filter(year > 1937) %>%
group_by(year) %>%
summarise(mean_C = mean(monthly_mean),
med_C = mean(monthly_median)
max_C = mean(monthly_mean),
min_C = mean(monthly_mean),
cv_C = mean(monthly_cv))
elahi_sst <- elahi_sst_monthly %>% filter(year > 1937) %>%
group_by(year) %>%
summarise(mean_C = mean(monthly_mean),
med_C = mean(monthly_median),
max_C = mean(monthly_mean),
min_C = mean(monthly_mean),
cv_C = mean(monthly_cv))
monthly_sstL <- elahi_sst_monthly %>% gather(key = metric, value = tempC, monthly_mean:monthly_cv)
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
head(dat4)
spYrs <- dat4 %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs$genus <- factor(spYrs$genus, levels = c("Chlorostoma", "Lottia", "Littorina"))
sstL %>% filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
# theme_bw(base_size = 10) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
#theme(legend.key.size = unit(0.2, "cm")) +
#theme(legend.text = element_text(size = 8))
sstL %>% #filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
# theme_bw(base_size = 10) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
#theme(legend.key.size = unit(0.2, "cm")) +
#theme(legend.text = element_text(size = 8))
sstL %>% #filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
# theme_bw(base_size = 10) +
#scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
#theme(legend.key.size = unit(0.2, "cm")) +
#theme(legend.text = element_text(size = 8))
elahi_sst <- elahi_sst_monthly %>% filter(year > 1937) %>%
group_by(year) %>%
summarise(mean_C = mean(monthly_mean),
med_C = mean(monthly_median),
max_C = mean(monthly_mean),
min_C = mean(monthly_min),
cv_C = mean(monthly_cv))
names(sst_monthly)
elahi_sst <- elahi_sst_monthly %>% filter(year > 1937) %>%
group_by(year) %>%
summarise(mean_C = mean(monthly_mean),
med_C = mean(monthly_median),
max_C = mean(monthly_max),
min_C = mean(monthly_min),
cv_C = mean(monthly_cv))
monthly_sstL <- elahi_sst_monthly %>% gather(key = metric, value = tempC, monthly_mean:monthly_cv)
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
sstL <- elahi_sst %>% gather(key = metric, value = tempC, mean_C:cv_C)
sstL %>% filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
# theme_bw(base_size = 10) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
#theme(legend.key.size = unit(0.2, "cm")) +
spYrs <- dat4 %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs$genus <- factor(spYrs$genus, levels = c("Chlorostoma", "Lottia", "Littorina"))
spYrs
spYrs <- dat5 %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs
spYrs <- dat2 %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs
spYrs <- dat %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs
spYrs <- dat4 %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs
dat4 %>% select(species, year) %>% distinct()
head(dat4)
unique(dat4$year)
spYrs <- dat4 %>% ungroup() %>% select(species, year) %>% distinct() %>%
arrange(species, year) %>%
group_by(species) %>%
mutate(genus = unlist(strsplit(as.character(species), split = " +"))[1]) %>%
ungroup()
spYrs
spYrs$genus <- factor(spYrs$genus, levels = c("Chlorostoma", "Lottia", "Littorina"))
sstL %>% filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_line(alpha = 1) +
# theme_bw(base_size = 10) +
scale_color_manual(values = c("red", "black", "blue")) +
# geom_smooth(method = "lm")  +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
#theme(legend.key.size = unit(0.2, "cm")) +
#theme(legend.text = element_text(size = 8))
sstL %>% filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
scale_color_manual(values = c("red", "black", "blue")) +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
sstL %>% filter(metric != "cv_C" & metric != "mean_C") %>%
ggplot(aes(year, tempC, color = metric)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
scale_color_manual(values = c("red", "black", "blue")) +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10.5, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
ggDat <- sstL %>% filter(metric != "cv_C" & metric != "mean_C")
ggDat %>%
ggplot(aes(year, tempC, color = metric)) +
geom_point(alpha = 0.5) +
#geom_smooth(method = "lm") +
scale_color_manual(values = c("red", "black", "blue")) +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10.5, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top") +
geom_smooth(data = subset(ggDat,
metric == "median_C" | metric == "max_C"),
aes(year, tempC),
method = "lm", color = c("red", "black"))
ggDat %>%
ggplot(aes(year, tempC, color = metric)) +
geom_point(alpha = 0.5) +
#geom_smooth(method = "lm") +
scale_color_manual(values = c("red", "black", "blue")) +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10.5, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top") +
geom_smooth(data = subset(ggDat,
metric == "median_C" | metric == "max_C"),
aes(year, tempC),
method = "lm")
ggDat %>%
ggplot(aes(year, tempC, color = metric)) +
geom_point(alpha = 0.5) +
#geom_smooth(method = "lm") +
scale_color_manual(values = c("red", "black", "blue")) +
ylab(expression(paste("Temperature (", degree, "C)"))) +
xlab("Year") +
geom_point(aes(x = year, y = 10.5, shape = genus, color = NULL), data = spYrs,
alpha = 0.5, size = 3) +
guides(color = FALSE) +
theme(legend.title = element_blank()) +
theme(legend.position = "top") +
geom_smooth(data = subset(ggDat,
metric == "med_C" | metric == "max_C"),
aes(year, tempC),
method = "lm")
ggsave("figs/hms_temperature.png", height = 3.5, width = 3.5)
