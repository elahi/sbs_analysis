theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
ggsave("figs/temp_timeseries_resids.png", height = 5, width = 7)
spectra_df %>%
ggplot(aes(freq, spec, color = metric))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra <- spectra_df %>%
ggplot(aes(freq, spec, color = metric))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
ggsave("figs/temp_timeseries_spectra.png", height = 5, width = 7)
library(cowplot)
plot_grid(plot_resids, plot_spectra, labels = c("A", "B"))
theme_set(theme_bw(base_size = 12))
plot_grid(plot_resids, plot_spectra, labels = c("A", "B"), ncol = 1)
plot_grid(plot_resids, plot_spectra, labels = c("A", "B"), nrow = 2, align = "v")
plot_resids_spectra <- plot_grid(plot_resids, plot_spectra, labels = c("A", "B"), nrow = 2, align = "v")
save_plot("figs/plot_resids_spectra.png", plot_resids_spectra,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3
)
plot_resids_spectra <- plot_grid(plot_resids, plot_spectra, labels = c("A", "B"), nrow = 2, align = "v")
save_plot("figs/plot_resids_spectra.png", plot_resids_spectra,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3
)
?save_plot
save_plot("figs/plot_resids_spectra.png", plot_resids_spectra,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3,
base_height = 7
)
save_plot("figs/plot_resids_spectra.png", plot_resids_spectra,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3,
base_width = 7
)
plot_resids <- temp_records3 %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.1, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
plot_resids
plot_resids <- temp_records3 %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
ggsave("figs/temp_timeseries_resids.png", height = 5, width = 7)
plot_resids_spectra <- plot_grid(plot_resids, plot_spectra, labels = c("A", "B"), nrow = 2, align = "v")
save_plot("figs/plot_resids_spectra.png", plot_resids_spectra,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3,
base_width = 7
)
temp_records3 %>%
filter(dataset == "Seawater" & metric == "Minimum") %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "Minimum") %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
temp_records3
temp_records3 %>%
filter(dataset == "Seawater" & metric == "Minimum") %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1)
temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val, color = metric)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = metric), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 3, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_spectra_min <- spectra_df %>%
ggplot(aes(freq, spec, color = NULL))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min
plot_spectra_min <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(freq, spec, color = NULL))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min
plot_spectra_min <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(freq, spec, color = NULL))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
#facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 2, align = "v")
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.3,
base_width = 3.5
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 1, # we're saving a grid plot of 2 columns
nrow = 2, # and 2 rows
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.1,
base_width = 3.5
)
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 1, align = "h")
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
# each individual subplot should have an aspect ratio of 1.3
base_aspect_ratio = 1.1,
base_width = 7
)
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 4, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 1, align = "h")
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.3,
base_width = 7
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1,
base_width = 7
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1, base_height = 3.5
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.1, base_height = 3.5
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.3, base_height = 3.5
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_width = 7, base_height = 3.5
)
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from\nmean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 1, align = "h")
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.3, base_height = 3.5
)
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from mean temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_spectra_min <- spectra_df %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(freq, spec, color = NULL))  +
geom_vline(aes(xintercept = 1/18.6), linetype = "solid", color = "gray", alpha = 0.5,
size = 2) +
geom_line() + geom_point() +
xlab("Frequency (1/yr)") + ylab("Spectrum") +
#facet_grid(dataset ~ metric, switch = "y") +
theme(strip.background = element_blank()) +
theme(legend.title = element_blank()) +
theme(legend.position = "none")
plot_spectra_min
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 1, align = "h")
?plot_grid
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.3, base_height = 3.5
)
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.2, base_height = 3.5
)
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
ylab(expression(paste("Deviation from fitted temperature\n(", degree, "C)"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
?atop
?bquote
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(as.list(expression(paste("Histogram of " , hat(mu)), "Bootstrap samples, Allianz"))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(as.list(expression(paste("Histogram of " , hat(mu)), "Bootstrap samples, Allianz")))
temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(expression(atop("A long string of text for the purpose", paste("of illustrating my point" [reported]))))
temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(expression(atop("A long string of text for the purpose", paste("of illustrating my point"))))
temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(expression(atop("Deviation from fitted temperature", paste("(", degree, "C)"))))
plot_resids_min <- temp_records3 %>%
filter(dataset == "Seawater" & metric == "minimum") %>%
ggplot(aes(year, resid_val)) +
geom_point(aes(value, y_position, color = NULL), alpha = 0.3, size = 5, data = moon_df) +
geom_line(alpha = 0.5, size = 0.5) +
geom_point(alpha = 0.5, size = 1) +
#facet_grid(dataset ~ metric, switch = "y") +
geom_hline(aes(yintercept = 0), linetype = "dashed", color = "gray") +
#ylab(expression(paste("Deviation from fitted temperature (", degree, "C)"))) +
ylab(expression(atop("Deviation from fitted", paste("temperature (", degree, "C)")))) +
xlab("Year") +
theme(legend.title = element_blank()) +
theme(legend.position = "none") +
geom_point(aes(x = year, y = -2, shape = species, color = NULL), data = spYrs,
alpha = 0.6, size = 2) +
guides(shape = FALSE) +
geom_line(aes(year, temp_ma, color = NULL), size = 1) +
theme(strip.background = element_blank())
plot_resids_min
plot_resids_spectra_min <- plot_grid(plot_resids_min, plot_spectra_min, labels = c("A", "B"),
nrow = 1, align = "h")
save_plot("figs/plot_resids_spectra_min.png", plot_resids_spectra_min,
ncol = 2, nrow = 1,
base_aspect_ratio = 1.2, base_height = 3.5
)
##################
citation("astsa")
