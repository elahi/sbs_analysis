summary(mod_null)
mod_1 <- lmer(size1mm ~ era +
(era | sampleArea) + (era | species),
data = statDat)
mod_1
mod_2 <- lmer(size1mm ~ era +
(era | sampleArea) + (1),
data = statDat, REML = FALSE)
anova(mod_1, mod_2)
mod_2 <- lmer(size1mm ~ era +
(era | sampleArea) + (1 | species),
data = statDat, REML = FALSE)
anova(mod_1, mod_2)
mod_3 <- lmer(size1mm ~ era +
(1 | sampleArea) + (1 | species),
data = statDat, REML = FALSE)
anova(mod_1, mod_2, mod_3)
summary(mod_3)
mod_3 <- lmer(size1mm ~ era +
(1 | species) + (1 | species:sampleArea),
data = statDat, REML = FALSE)
summary(mod_3)
mod_3 <- lmer(size1mm ~ era +
(era | species) + (era | species:sampleArea),
data = statDat, REML = FALSE)
summary(mod_3)
spp_era_means <- statDat %>% group_by(era, species) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm)) %>%
arrange(species, sampleArea, era)
spp_era_means <- statDat %>% group_by(era, species) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm)) %>%
arrange(species, era)
spp_era_means
spp_era_means <- statDat %>% group_by(era, species) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm)) %>%
arrange(species, era)
spp_era_means %>% filter(era == "past") %>%
select(species, size_mean, size_sd) %>%
rename(past_size_mean = size_mean, past_size_sd = size_sd)
spp_era_means %>% filter(era == "past") %>%
select(species, size_mean, size_sd)
?select
spp_past_means <- statDat %>% filter(era == "past") %>%
group_by(species) %>%
summarise(n = n(),
past_size_mean = mean(size1mm),
past_size_sd = sd(size1mm))
spp_past_means
spp_past_means <- statDat %>% filter(era == "past") %>%
group_by(species) %>%
summarise(past_size_mean = mean(size1mm),
past_size_sd = sd(size1mm))
spp_past_means
statDat <- inner_join(statDat, spp_past_means, by = "species")
statDat <- dat5
unique(statDat$sample_area_tidal_ht)
glimpse(statDat)
### calculate the z-score for each species relative to past
spp_past_means <- statDat %>% filter(era == "past") %>%
group_by(species) %>%
summarise(past_size_mean = mean(size1mm),
past_size_sd = sd(size1mm))
spp_past_means
statDat2 <- inner_join(statDat, spp_past_means, by = "species")
View(statDat2)
statDat3 <- statDat2 %>%
mutate(size_centered = size1mm - past_size_mean,
size_z = size_centered/past_size_sd)
statDat3 %>%
ggplot(aes(era, size_centered)) +
geom_boxplot() +
facet_wrap(~ species)
statDat3 %>%
ggplot(aes(era, size_z)) +
geom_boxplot() +
facet_wrap(~ species)
mod_1 <- lmer(size_centered ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
mod_1 <- lmer(size1mm ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
mod_1 <- lmer(size_z ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
mod_1
mod_1 <- lmer(size1mm ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
mod_1
mod_1 <- lmer(size_centered ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
mod_1
mod_3 <- lmer(size1mm ~ era +
(era | species) + (era | species:sampleArea),
data = statDat, REML = FALSE)
mod_3
mod_3 <- lmer(size1mm ~ era +
(era | species) + (1 | species:sampleArea),
data = statDat, REML = FALSE)
mod_3
mod_3 <- lmer(size1mm ~ era * species +
(1 | sampleArea) +
data = statDat, REML = FALSE)
mod_3
mod_3 <- lmer(size1mm ~ era * species +
(1 | sampleArea) +
data = statDat, REML = FALSE)
mod_3 <- lmer(size1mm ~ era * species + (1 | sampleArea) +
data = statDat, REML = FALSE)
mod_3 <- lmer(size1mm ~ era * species + (1 | sampleArea) +
data = statDat3, REML = FALSE)
mod_3 <- lmer(size1mm ~ era * species + (1 | sampleArea),
data = statDat3, REML = FALSE)
mod_3
mod_3 <- lmer(size1mm ~ era + species + (1 | sampleArea),
data = statDat3, REML = FALSE)
Cand.mod <- list()
Cand.mod[[1]] <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea), data = statDat, method = "ML")
Cand.mod[[1]] <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea), data = statDat, REML = "FALSE")
Cand.mod[[2]] <- update(Cand.mod[[1]], ~. - era:species:sample_area_tidal_ht)
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species)
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht)
# Set up candidate model list
Cand.mod <- list()
# final full model
Cand.mod[[1]] <- lme(fixed = size1mm ~ era * species * sample_area_tidal_ht,
random = list(~ 1 | sampleArea),
na.action = na.omit, method = "ML",
data = statDat)
Cand.mod[[2]] <- update(Cand.mod[[1]], ~. - era:species:sample_area_tidal_ht)
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species)
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht)
Cand.mod[[5]] <- update(Cand.mod[[1]], ~ era * sample_area_tidal_ht)
Cand.mod[[6]] <- update(Cand.mod[[1]], ~ species)
Cand.mod[[7]] <- update(Cand.mod[[1]], ~ era)
Cand.mod[[8]] <- update(Cand.mod[[1]], ~ sample_area_tidal_ht)
Cand.mod[[9]] <- update(Cand.mod[[1]], ~ 1)
#create a vector of names to trace back models in set
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way intx",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set= Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
# Format the data frame for nicer printing
aic_table <- data.frame(cbind(data.frame(mod.aicctab)[1],
round(data.frame(mod.aicctab)[2:8], 3)))
mod_3way <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = statDat3, REML = FALSE)
mod_3way
model_2  <- update(model_1, .~. - era : species : sample_area_tidal_ht)
model_1 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = statDat3, REML = FALSE)
model_2  <- update(model_1, .~. - era : species : sample_area_tidal_ht)
mod_1 <- lmer(size_centered ~ era +
anova(model_1, model_2)
model_3 <- lmer(size1mm ~ era +
(era | sampleArea) + (era | species),
data = statDat3, REML = FALSE)
model_3
model_3 <- lmer(size1mm ~ era +
(era | sampleArea) + (1 | species),
data = statDat3, REML = FALSE)
model_3
model_3 <- lmer(size1mm ~ era +
(1 | sampleArea) + (1 | species),
data = statDat3, REML = FALSE)
model_3
model_3 <- lmer(size1mm ~ era +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
model_3
model_1 <- lmer(size1mm ~ era +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
model_1
model_2 <- lmer(size1mm ~ 1 +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
model_2
anova(model_1, model_2)
model_3 <- lmer(size1mm ~ era * sample_area_tidal_ht +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
model_3
model_4 <- lmer(size1mm ~ era + sample_area_tidal_ht +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
anova(model_3, model_4)
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = statDat3, REML = FALSE)
model_6  <- update(model_1, .~. - era : species : sample_area_tidal_ht)
anova(model_5, model_6)
Cand.mod <- list()
Cand.mod[[1]] <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea), data = statDat, REML = "FALSE")
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species +
(1 | sampleArea))
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[5]] <- update(Cand.mod[[1]], ~ era * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[6]] <- update(Cand.mod[[1]], ~ species +
(1 | sampleArea))
Cand.mod[[7]] <- update(Cand.mod[[1]], ~ era +
(1 | sampleArea))
Cand.mod[[8]] <- update(Cand.mod[[1]], ~ sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[9]] <- update(Cand.mod[[1]], ~ 1 +
(1 | sampleArea))
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way intx",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set= Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
summary(Cand.mod[[7]])
?aictab
# Set up candidate model list
Cand.mod <- list()
# final full model
Cand.mod[[1]] <- lme(fixed = size1mm ~ era * species * sample_area_tidal_ht,
random = list(~ 1 | sampleArea),
na.action = na.omit, method = "ML",
data = statDat)
Cand.mod[[2]] <- update(Cand.mod[[1]], ~. - era:species:sample_area_tidal_ht)
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species)
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht)
Cand.mod[[5]] <- update(Cand.mod[[1]], ~ era * sample_area_tidal_ht)
Cand.mod[[6]] <- update(Cand.mod[[1]], ~ species)
Cand.mod[[7]] <- update(Cand.mod[[1]], ~ era)
Cand.mod[[8]] <- update(Cand.mod[[1]], ~ sample_area_tidal_ht)
Cand.mod[[9]] <- update(Cand.mod[[1]], ~ 1)
#create a vector of names to trace back models in set
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way intx",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set= Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
Cand.mod <- list()
# final full model
Cand.mod[[1]] <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea), data = statDat, REML = "FALSE")
Cand.mod[[2]] <- update(Cand.mod[[1]], ~. - era:species:sample_area_tidal_ht)
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species +
(1 | sampleArea))
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[5]] <- update(Cand.mod[[1]], ~ era * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[6]] <- update(Cand.mod[[1]], ~ species +
(1 | sampleArea))
Cand.mod[[7]] <- update(Cand.mod[[1]], ~ era +
(1 | sampleArea))
Cand.mod[[8]] <- update(Cand.mod[[1]], ~ sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[9]] <- update(Cand.mod[[1]], ~ 1 +
(1 | sampleArea))
summary(Cand.mod[[7]])
summary(Cand.mod[[2]])
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way intx",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set = Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord = FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
# Format the data frame for nicer printing
aic_table <- data.frame(cbind(data.frame(mod.aicctab)[1],
round(data.frame(mod.aicctab)[2:8], 3)))
fullMod <- update(Cand.mod[[1]], REML = "TRUE")
summary(fullMod)
plot(fullMod)
Cand.mod[[1]] <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea), data = statDat, REML = "FALSE")
Cand.mod[[2]] <- update(Cand.mod[[1]], ~. - era:species:sample_area_tidal_ht)
Cand.mod[[3]] <- update(Cand.mod[[1]], ~ era * species +
(1 | sampleArea))
Cand.mod[[4]] <- update(Cand.mod[[1]], ~ species * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[5]] <- update(Cand.mod[[1]], ~ era * sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[6]] <- update(Cand.mod[[1]], ~ species +
(1 | sampleArea))
Cand.mod[[7]] <- update(Cand.mod[[1]], ~ era +
(1 | sampleArea))
Cand.mod[[8]] <- update(Cand.mod[[1]], ~ sample_area_tidal_ht +
(1 | sampleArea))
Cand.mod[[9]] <- update(Cand.mod[[1]], ~ 1 +
(1 | sampleArea))
summary(Cand.mod[[2]])
mod_numbers <- paste("Cand.mod", 1:length(Cand.mod), sep=" ")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way intx",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set = Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord = FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
# Format the data frame for nicer printing
aic_table <- data.frame(cbind(data.frame(mod.aicctab)[1],
round(data.frame(mod.aicctab)[2:8], 3)))
summary(fullMod)
plot(fullMod)
anova(fullMod)
print(mod.aicctab, digits=2, LL=TRUE)
write.csv(aic_table, "output/AIC_eraXspeciesXtidalht_lmer.csv")
mod_text <- c("Era x Species x Tidal height",
"All three 2-way interactions",
"Era x Species", "Species x Tidal height", "Era x Tidal height",
"Species", "Era", "Tidal height", "Null model")
#generate AICc table with numbers
mod.aicctab <- aictab(cand.set = Cand.mod, modnames=mod_numbers, sort=TRUE,
second.ord = FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
#generate AICc table with names
mod.aicctab <- aictab(cand.set= Cand.mod, modnames= mod_text, sort=TRUE,
second.ord=FALSE) # second.ord =TRUE means AICc is used (not AIC)
print(mod.aicctab, digits=2, LL=TRUE)
# Format the data frame for nicer printing
aic_table <- data.frame(cbind(data.frame(mod.aicctab)[1],
round(data.frame(mod.aicctab)[2:8], 3)))
write.csv(aic_table, "output/AIC_eraXspeciesXtidalht_lmer.csv")
fullMod <- update(Cand.mod[[1]], REML = "TRUE")
summary(fullMod)
plot(fullMod)
anova(fullMod)
model_7 <- lmer(size1mm ~ era + species +
(era | sampleArea),
data = statDat3, REML = FALSE)
model_8  <- update(model_1, .~. - era)
anova(model_7, model_8)
plot(model_8)
plot(model_7)
model_8
model_8  <- update(model_1, ~ species +
(era | sampleArea))
model_7 <- lmer(size1mm ~ era + species +
(era | sampleArea),
data = statDat3, REML = FALSE)
model_8  <- update(model_7, ~ species +
(era | sampleArea))
anova(model_7, model_8)
plot(model_7)
model_8
model_7 <- lmer(size1mm ~ era + species +
(1 | sampleArea),
data = statDat3, REML = FALSE)
model_8  <- update(model_7, ~ species +
(1 | sampleArea))
anova(model_7, model_8)
model_8
model_7
AIC(model_7, model_8)
unique(statDat$sampleArea)
anova(model_1, model_2)
spp_past_means
statDat %>%
group_by(era, species, sampleArea, sample_area_tidal_ht) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm)) %>%
arrange(species, sampleArea, era)
statDat %>%
group_by(era, species) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm)) %>%
arrange(species, sampleArea, era)
statDat %>%
group_by(era, species) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm))
statDat %>%
group_by(species, era) %>%
summarise(n = n(),
size_mean = mean(size1mm),
size_sd = sd(size1mm))
statDat %>%
group_by(species, era) %>%
summarise(size_mean = mean(size1mm))
?spread
statDat %>%
group_by(species, era) %>%
summarise(size_mean = mean(size1mm)) %>%
spread(key = era, value = size_mean)
statDat %>%
group_by(species, era) %>%
summarise(size_mean = mean(size1mm)) %>%
spread(key = era, value = size_mean) %>%
mutate(size_diff = past - present,
size_per = size_diff/past * 100)
dat4 %>%
group_by(species, era) %>%
summarise(size_mean = mean(size1mm)) %>%
spread(key = era, value = size_mean) %>%
mutate(size_diff = past - present,
size_per = size_diff/past * 100)
dat4 %>%
group_by(species, era) %>%
summarise(size_mean = mean(size1mm, na.rm = TRUE)) %>%
spread(key = era, value = size_mean) %>%
mutate(size_diff = past - present,
size_per = size_diff/past * 100)
dat4 %>%
group_by(species, era) %>%
summarise(size_mean = median(size1mm, na.rm = TRUE)) %>%
spread(key = era, value = size_mean) %>%
mutate(size_diff = past - present,
size_per = size_diff/past * 100)
dat4 %>%
group_by(species, era) %>%
summarise(size_stat = max(size1mm, na.rm = TRUE)) %>%
spread(key = era, value = size_stat) %>%
mutate(size_diff = past - present,
size_per = size_diff/past * 100)
fullMod <- update(Cand.mod[[1]], REML = "TRUE", data = dat4)
summary(fullMod)
plot(fullMod)
anova(fullMod)
lmeMod1 <- lme(fixed = size1mm ~ era * species * sample_area_tidal_ht,
random = list(~ 1 | sampleArea),
na.action = na.omit, method = "REML",
data = dat4)
summary(lmeMod1)
round(summary(lmeMod1)$tTable, 3)
anova(lmeMod1)
plot(lmeMod1)
lmeMod1 <- lme(fixed = size1mm ~ era * species * sample_area_tidal_ht,
random = list(~ 1 | sampleArea),
na.action = na.omit, method = "REML",
data = statDat)
anova(lmeMod1)
## Test general effect of era
model_1 <- lmer(size1mm ~ era +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
model_1
model_2 <- lmer(size1mm ~ 1 +
(1 | species) + (1 | species:sampleArea),
data = statDat3, REML = FALSE)
anova(model_1, model_2)
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = statDat3, REML = FALSE)
model_6  <- update(model_1, .~. - era : species : sample_area_tidal_ht)
anova(model_5, model_6)
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = dat4, REML = FALSE)
model_6  <- update(model_1, .~. - era : species : sample_area_tidal_ht)
anova(model_5, model_6)
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = dat4, REML = FALSE)
model_6  <- update(model_5, .~. - era : species : sample_area_tidal_ht)
anova(model_5, model_6)
## Test effect of era
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = statDat3, REML = FALSE)
model_6  <- update(model_5, .~. - era : species : sample_area_tidal_ht)
anova(model_5, model_6)
model_6
model_5 <- lmer(size1mm ~ era * species * sample_area_tidal_ht +
(1 | sampleArea),
data = dat4, REML = FALSE)
model_6  <- update(model_5, .~. - era : species : sample_area_tidal_ht)
model_6
anova(model_5, model_6)
8998-8056
