position = position_dodge(width = my_dodge)) +
geom_point(aes(size = n), position = position_dodge(width = my_dodge), pch = 21) +
coord_flip() +
labs(x = "", y = "Model coefficient") +
scale_fill_viridis_d(begin = 0.25, end = 0.75) +
theme(legend.title = element_blank(),
legend.position = c(0.95, 0.99),
legend.justification = c(0.95, 0.99)) +
scale_size_continuous(range = c(2,4), guide = FALSE) +
guides(fill = guide_legend(override.aes = list(size = c(4, 2)))) +
scale_y_continuous(breaks = seq(-0.25, 1.00, 0.25))
p1
ggsave("sbs_meta/meta_figs/meta_lme_coefs.pdf", height = 4, width = 7)
ggsave("sbs_meta/meta_figs/meta_lme_coefs.pdf", height = 3.5, width = 5)
library(cowplot)
library(dplyr)
options(tibble.print_max = 50, tibble.print_min = 10)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
strip.text = element_text(face = "italic"),
panel.grid = element_blank()))
install.packages("cowplot")
library(cowplot)
library(dplyr)
options(tibble.print_max = 50, tibble.print_min = 10)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
strip.text = element_text(face = "italic"),
panel.grid = element_blank()))
## Load bayesian analysis results
coda_df_logsize_density <- read.csv("3_analyse_data/bayes_output/logsize_density/coda_df_all.csv") %>%
mutate(model = "With density")
coda_df_logsize <- read.csv("3_analyse_data/bayes_output/logsize/coda_df_all.csv") %>%
mutate(model = "Without density")
names(coda_df_logsize)
names(coda_df_logsize_density)
coda_df_all <- rbind(coda_df_logsize, coda_df_logsize_density)
species_df <- data.frame(sp = c("CHFU", "LODI", "LIKE"),
species = c("Chlorostoma funebralis", "Lottia digitalis", "Littorina keenae"))
coda_df_all <- left_join(coda_df_all, species_df, by = "sp")
# Reorder levels
species <- factor(coda_df_all$species, levels = rev(c("Littorina keenae",
"Lottia digitalis",
"Chlorostoma funebralis")))
coda_df_all$species <- species
facet_panels <- coda_df_all %>%
filter(!is.na(species)) %>%
select(species) %>% distinct() %>%
arrange(species)
facet_panels
facet_panels <- facet_panels %>%
mutate(facet_labels = paste(LETTERS)[1:3]) %>%
arrange(facet_labels)
coda_df_all <- coda_df_all %>%
inner_join(., facet_panels, by = c("species"))
str(coda_df_all$model)
coda_df_all$model <- factor(coda_df_all$model, levels = c("Without density", "With density"))
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp != "CHFU_means") %>%
ggplot(aes(quant, X50., color = model)) +
geom_point() +
geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size (mm)") +
xlab("Size threshold (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "darkgray")) +
#scale_linetype_manual(values = c("black", "darkgray")) +
geom_text(data = facet_panels, aes(0, 0.18, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 0, nudge_y = 0.00)
## Plot Littorina only
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
ggplot(aes(quant, X50., color = model)) +
geom_point() +
geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
coda_df_all
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50)) +
geom_point() +
#geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50)) +
geom_point()
facet_panels <- coda_df_all %>%
filter(!is.na(species)) %>%
select(species) %>% distinct() %>%
arrange(species)
facet_panels
facet_panels <- facet_panels %>%
mutate(facet_labels = paste(LETTERS)[1:3]) %>%
arrange(facet_labels)
coda_df_all <- coda_df_all %>%
inner_join(., facet_panels, by = c("species"))
str(coda_df_all$model)
coda_df_all$model <- factor(coda_df_all$model, levels = c("Without density", "With density"))
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp != "CHFU_means") %>%
ggplot(aes(quant, X50., color = model)) +
geom_point() +
geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size (mm)") +
xlab("Size threshold (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "darkgray")) +
#scale_linetype_manual(values = c("black", "darkgray")) +
geom_text(data = facet_panels, aes(0, 0.18, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 0, nudge_y = 0.00)
## Plot Littorina only
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
ggplot(aes(quant, X50., color = model)) +
geom_point() +
geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50)) +
geom_point() +
#geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
#filter(model == "With density") %>%
ggplot(aes(quant, X50)) +
geom_point() +
#geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
unique(coda_df_all$model)
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density")
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50.)) +
geom_point() +
#geom_line(aes(linetype = model)) +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species)
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50.)) +
geom_point() +
geom_line() +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species) +
scale_color_manual(values = c("black", "red"))
ggsave("figs_ms/plot_prop_change_like_wo_density.pdf", height = 3.5, width = 3.5)
library(grid)
source("R/choose_size_data.R")
source("R/choose_size_threshold.R")
# load data - approximated sizes
dat <- choose_size_data(method = "normal")
# Do not remove any data
dat2 <- choose_size_threshold(x = dat, era = "combined", filter_data = F) %>%
filter(!is.na(size1mm))
names(dat2)
unique(dat2$species)
# plotting functions
source("./R/multiplotF.R")
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
#panel.grid = element_blank()),
strip.text = element_text(face = "italic")))
##### PROBABILITY DENSITY PLOT #####
n_df <- dat2 %>% filter(!is.na(size1mm)) %>%
group_by(species, era) %>% summarise(n = n()) %>%
ungroup()
n_df
yr_df <- dat2 %>% filter(!is.na(size1mm)) %>%
group_by(species, era) %>% distinct(year) %>% ungroup()
facet_panels <- dat2 %>% select(species) %>% distinct() %>%
arrange(species)
facet_panels
facet_panels <- facet_panels %>%
mutate(facet_labels = paste(LETTERS)[1:3]) %>%
arrange(facet_labels) %>%
mutate(past_text = c("1963; n=817", "1950; n=493", "1947; n=682"),
present_text = c("2014; n=5646", "2015; n=605", "2014; n=733"))
dat3 <- dat2 %>%
inner_join(., facet_panels, by = c("species"))
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c("red", "black")) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = "red", hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = "black", hjust = 0)
plot_histo_panel <- function(df, bin_width = 1) {
p <- ggplot(df,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = bin_width,
color = "black", fill = "gray") +
xlab("Size (mm)") + ylab("Proportion")
return(p)
}
theme_set(theme_bw(base_size = 10))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae") +
theme(plot.title = element_text(size = 6, face = "italic",
hjust = 0.5, vjust = 0.9))
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "F",
x = 1, y = 0.2, vjust = 1, hjust = -0.05)
multiplot(fig1e, fig1f, cols = 1)
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae") +
theme(plot.title = element_text(size = 6, face = "italic",
hjust = 0.5, vjust = 0.9))
# Littorina keenae
childsDF <- droplevels(filter(dat2, sp == "LIKE"))
childsPast <- childsDF %>% filter(era == "past")
childsPres <- childsDF %>% filter(era == "present")
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae") +
theme(plot.title = element_text(size = 6, face = "italic",
hjust = 0.5, vjust = 0.9))
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "F",
x = 1, y = 0.2, vjust = 1, hjust = -0.05)
multiplot(fig1e, fig1f, cols = 1)
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae")
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
multiplot(fig1e, fig1f, cols = 1)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae")
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
multiplot(fig1e, fig1f, cols = 1)
plot_histo_panel <- function(df, bin_width = 1) {
p <- ggplot(df,  aes(x = size1mm)) +
geom_histogram(aes(y = ..count../sum(..count..)), binwidth = bin_width,
color = "white", fill = "black") +
xlab("Size (mm)") + ylab("Proportion")
return(p)
}
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae")
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
multiplot(fig1e, fig1f, cols = 1)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1) +
annotate("text", label = "E",
x = 1, y = 0.2, vjust = 1, hjust = -0.05) +
ggtitle("Littorina keenae")
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
multiplot(fig1e, fig1f, cols = 1)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
multiplot(fig1e, fig1f, cols = 1)
# save as 7 x 3.5 pdf
pdf("figs_ms/plot_size_frequency_littorina.pdf", 7, 3.5)
multiplot(fig1e, fig1f, cols = 1)
dev.off()
theme_set(theme_bw(base_size = 18) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 2.2, vjust = 1, hjust = 1)
# save as 7 x 3.5 pdf
pdf("figs_ms/plot_size_frequency_littorina.pdf", 3.5, 3.5)
multiplot(fig1e, fig1f, cols = 1)
dev.off()
# save as 7 x 3.5 pdf
pdf("figs_ms/plot_size_frequency_littorina.pdf", width = 3.5, height = 7)
multiplot(fig1e, fig1f, cols = 1)
dev.off()
fig1e <- plot_histo_panel(childsPast) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "1947\nn = 682",
x = 21, y = 0.2, size = 4.2, vjust = 1, hjust = 1)
fig1f <- plot_histo_panel(childsPres) +
scale_x_continuous(limits = c(1, 21)) +
scale_y_continuous(limits = c(0, 0.2)) +
annotate("text", label = "2014\nn = 733",
x = 21, y = 0.2, size = 4.2, vjust = 1, hjust = 1)
# save as 7 x 3.5 pdf
pdf("figs_ms/plot_size_frequency_littorina.pdf", width = 3.5, height = 7)
multiplot(fig1e, fig1f, cols = 1)
dev.off()
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50.)) +
geom_point() +
#geom_line() +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species)
ggsave("figs_ms/plot_prop_change_like_wo_density.pdf", height = 3.5, width = 3.5)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
strip.text = element_text(face = "italic"),
panel.grid = element_blank()))
## Plot Littorina, without density
coda_df_all %>%
filter(param == "prop_change") %>%
filter(sp == "LIKE") %>%
filter(model == "With density") %>%
ggplot(aes(quant, X50.)) +
geom_point() +
#geom_line() +
geom_errorbar(aes(ymin = X2.5., ymax = X97.5.), width = 0.025) +
geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
ylab("Proportional change in size") +
xlab("Size threshold for inclusion\n (quantile of past size)") +
theme(legend.title = element_blank()) +
theme(legend.position = c(0.99, 0.01), legend.justification = c(0.99, 0.01)) +
#coord_cartesian(ylim = c(-0.4, 0.4)) +
facet_wrap(~ species)
ggsave("figs_ms/plot_prop_change_like_wo_density.pdf", height = 3.5, width = 3.5)
