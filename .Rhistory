ggplot(aes(dens, pred2)) +
#geom_point(size = 0.1) +
facet_wrap(~ species) +
geom_smooth(method = "lm")
new.dat %>%
ggplot(aes(dens, pred2)) +
#geom_point(size = 0.1) +
facet_wrap(~ species) +
geom_smooth(method = "lm")
new.dat %>%
ggplot(aes(dens, pred)) +
#geom_point(size = 0.1) +
facet_wrap(~ species) +
geom_smooth(method = "lm")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
geom_smooth(method = "lm", fill = NA) +
geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_point(aes(dens, pred), data = new.dat, inherit.aes = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
geom_smooth(method = "lm", fill = NA) +
geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(aes(dens, pred), data = new.dat, inherit.aes = FALSE)
bestMod <- update(Cand.mod[[1]], method = "REML")
summary(bestMod)$tTable
plot(bestMod)
anova(bestMod)
bestMod$tT
## Predict values from this model, and then fit regression lines
##???
x_range <- range(statPres$dens_log)
x_min <- min(statPres$dens_log)
x_max <- max(statPres$dens_log)
#create data.frame with new values for predictors
#more than one predictor is possible
dens_log = seq(x_min, x_max, 0.01)
x_length = length(dens_log)
new.dat <- data.frame(dens_log = rep(dens_log, 3))
new.dat$species <- c(rep("Chlorostoma funebralis", 262),
rep("Littorina keenae", 262),
rep("Lottia digitalis", 262))
#predict response
new.dat$pred <- predict(bestMod, newdata = new.dat, level=0)
new.dat$dens <- 10 ^ new.dat$dens_log
new.dat %>%
ggplot(aes(dens, pred)) +
#geom_point(size = 0.1) +
facet_wrap(~ species) +
geom_smooth(method = "lm")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
geom_smooth(method = "lm", fill = NA) +
geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(aes(dens, pred), data = new.dat, inherit.aes = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(aes(dens, pred), data = new.dat, inherit.aes = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE)
datMeans4
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
method = "lm", color = "darkgray", linetype = "dashed")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
aes(color = era),
method = "lm", color = "darkgray", linetype = "dashed")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
method = "lm", linetype = "dashed")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
method = "lm", linetype = "solid")
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
method = "lm", linetype = "solid", fill = NA) +
geom_smooth(data = subset(datMeans4, sp == "CHFU"),
method = "lm", linetype = "solid", show.legend = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", fill = NA) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", show.legend = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
aes(group = c(era, sampleArea))
method = "lm", linetype = "solid", fill = NA) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", show.legend = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
aes(group = c(era, sampleArea)),
method = "lm", linetype = "solid", fill = NA) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", show.legend = FALSE)
datMeans4 %>%
ggplot(aes(density_m2, size_mm, shape = species, color = era)) +
geom_point(alpha = 0.75, size = 2) +
facet_wrap(~ species) +
#geom_smooth(method = "lm", fill = NA) +
#geom_smooth(method = "lm", show.legend = FALSE) +
scale_x_log10() +
#scale_color_manual(values = c("darkgray", "black")) +
#scale_color_brewer(type = 'qual') +
#scale_color_manual(values = c("#1b9e77", "#d95f02")) +
theme(legend.position = c(0, 0.0), legend.justification = c(0, 0)) +
theme(legend.title = element_blank()) +
theme(legend.key = element_rect(fill = "white")) +
xlab(expression(paste("Density (no. ", m^-2, ")"))) +
ylab("Size (mm)") +
guides(shape = FALSE) +
geom_text(aes(x, y, label = text1, color = NULL, shape = NULL),
data = size_dens_text, size = 5, hjust = 1, show.legend = FALSE) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", fill = NA) +
geom_smooth(data = subset(datMeans4, sp == "CHFU" & era == "present"),
method = "lm", linetype = "solid", show.legend = FALSE)
ggsave("figs/elahi_size_era_density_3panel.png", height = 3.5, width = 7)
datMeans4 %>%
ggplot(aes(era, density_m2)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text")
give.n <- function(x){
return(c(y = median(x) + 5, label = length(x)))
}
datMeans4 %>%
ggplot(aes(era, density_m2)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text")
give.n <- function(x){
return(c(y = 0, label = length(x)))
}
datMeans4 %>%
ggplot(aes(era, density_m2)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text")
datMeans4 %>%
ggplot(aes(era, density_m2)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text") +
ylab(expression(paste("Density (no. ", m^-2, ")"))) +
xlab("")
datMeans4 %>%
ggplot(aes(era, density_m2, color = era)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text") +
ylab(expression(paste("Density (no. ", m^-2, ")")))
datMeans4 %>%
ggplot(aes(era, density_m2, color = era)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text") +
ylab(expression(paste("Density (no. ", m^-2, ")"))) +
xlab("")
datMeans4 %>%
ggplot(aes(era, density_m2)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text") +
ylab(expression(paste("Density (no. ", m^-2, ")"))) +
xlab("")
datMeans4 %>%
ggplot(aes(era, density_m2, color = era)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text", show.legend = FALSE) +
ylab(expression(paste("Density (no. ", m^-2, ")"))) +
xlab("")
datMeans4 %>%
ggplot(aes(era, density_m2, color = era)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ species, scales = "free_y") +
stat_summary(fun.data = give.n, geom = "text", show.legend = FALSE) +
ylab(expression(paste("Density (no. ", m^-2, ")"))) +
xlab("") +
theme(legend.position = "none")
ggsave("figs/elahi_size_era_density_box_3panel.png", height = 3.5, width = 7)
statCH <- statDat %>% filter(sp == "CHFU")
Cand.mod <- list()
statCH
statCH %>% group_by(era, site) %>% tally()
Cand.mod[[1]] <- lm(size_mm ~ era * site * dens_log,
data = statPres)
Cand.mod[[1]] <- lm(size_mm ~ era * site * dens_log,
data = statCH)
Cand.mod[[1]]
plot(lm)
mod1 <- lm(size_mm ~ era * site * dens_log,
data = statCH)
anova(mod1)
summary(mod1)
mod1 <- lm(size_mm ~ era * dens_log,
data = statCH)
anova(mod1)
summary(mod1)
mod1 <- lm(size_mm ~ era * site * dens_log,
data = statCH)
anova(mod1)
statCH %>%
ggplot(aes(size_mm, density_m2, color = era)) +
facet_wrap(~ site) +
geom_point()
statCH %>%
ggplot(aes(density_m2, size_mm, color = era)) +
facet_wrap(~ site) +
geom_point() +
scale_x_log10() +
geom_smooth(method = "lm")
statCH %>%
ggplot(aes(density_m2, size_mm, color = era)) +
facet_wrap(~ site) +
geom_point() +
scale_x_log10() +
geom_smooth(method = "loess")
statCH %>%
ggplot(aes(density_m2, size_mm, color = era)) +
facet_wrap(~ site) +
geom_point() +
scale_x_log10() +
geom_smooth(method = "lm")
statCH
datMeans
datMeans3 <- datMeans2 %>%
select(species, sp, site, era, tide_mean, size_mean, density_m2,
sampleArea, nest1, nest2, size_n) %>%
rename(tideHTm = tide_mean,
size_mm = size_mean)
datMeans3
unique(datMeans3$sampleArea)
waraPast <- waraPast %>%
mutate(sampleArea = site,
nest1 = NA,
nest2 = NA,
size_n = NA)
datMeans4 <- datMeans3 %>% rbind(., waraPast)
# Reorder levels
species <- factor(datMeans4$species, levels = rev(c("Littorina keenae",
"Lottia digitalis",
"Chlorostoma funebralis")))
datMeans4$species <- species
statDat <- statDat %>%
mutate(dens_log = log10(density_m2))
statDat <- datMeans4
statDat
unique(statDat$site)
statDat <- statDat %>%
mutate(dens_log = log10(density_m2))
statDat
statCH <- statDat %>% filter(sp == "CHFU")
statCH %>% group_by(era, site) %>% tally()
statCH %>%
ggplot(aes(density_m2, size_mm, color = era, size = size_n)) +
facet_wrap(~ site) +
geom_point() +
scale_x_log10() +
geom_smooth(method = "lm")
statCH %>%
ggplot(aes(density_m2, size_mm, color = era)) +
facet_wrap(~ site) +
geom_point() +
scale_x_log10() +
geom_smooth(method = "lm")
mod2 <- lm(size_mm ~ era, data = statCH)
mod2
anova(mod2)
anova(mod2)
plot(mod1)
plot(mod2)
statCH %>%
ggplot(aes(era, density_m2)) +
geom_boxplot()
statCH %>%
ggplot(aes(era, size_mm)) +
geom_boxplot()
statCH %>%
ggplot(aes(era, size_mm)) +
geom_boxplot(notch = TRUE)
statCH %>%
ggplot(aes(era, size_mm)) +
geom_boxplot(notch = FALSE)
### Model selection
statCH %>%
ggplot(aes(era, size_mm, color = era)) +
geom_boxplot(notch = FALSE)
statCH %>%
ggplot(aes(era, size_mm, color = era)) +
geom_boxplot(notch = FALSE) +
facet_wrap(~ site)
statCH %>%
ggplot(aes(era, size_mm, color = era)) +
geom_violin() +
facet_wrap(~ site)
statCH %>%
ggplot(aes(era, size_mm, color = era)) +
geom_boxplot() +
facet_wrap(~ site)
