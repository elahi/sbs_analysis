facet_panels <- facet_panels %>%
mutate(facet_labels = paste(LETTERS)[1:3]) %>%
arrange(facet_labels) %>%
mutate(past_text = c("1963; n=817", "1950; n=493", "1947; n=682"),
present_text = c("2014; n=5646", "2015; n=605", "2014; n=733"))
dat3 <- dat2 %>%
inner_join(., facet_panels, by = c("species"))
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
#panel.grid = element_blank()),
strip.text = element_text(face = "italic")))
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c("red", "black")) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = "red", hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = "black", hjust = 0)
library(viridis)
viridis()
viridis.map
viridis_pal()
viridis.map(2)
viridis(2)
viridis(1)
?viridis
vir_cols <- viridis(2)
past_color <- vir_cols[1]
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
panel.grid = element_blank()),
strip.text = element_text(face = "italic")))
vir_cols <- viridis(2)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
panel.grid = element_blank()),
strip.text = element_text(face = "italic"))
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
panel.grid = element_blank()),
strip.text = element_text(face = "italic"))
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
vir_cols <- viridis(2)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density.pdf", height = 3.5, width = 7)
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.5) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density.pdf", height = 3.5, width = 7)
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density.pdf", height = 3.5, width = 7)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 7, width = 10)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 5, width = 10)
vir_cols <- viridis(2, begin = 0, end = 0.5)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 5, width = 10)
vir_cols <- viridis(2, begin = 0, end = 0.75)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 5, width = 10)
vir_cols <- viridis(2, begin = 0.25, end = 1)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
theme_set(theme_bw(base_size = 16) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
vir_cols <- viridis(2, begin = 0.25, end = 1)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
vir_cols <- viridis(2, begin = 0, end = 0.75)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
theme_set(theme_bw(base_size = 24) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
vir_cols <- viridis(2, begin = 0, end = 0.75)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
theme_set(theme_bw(base_size = 20) +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
strip.text = element_text(face = "italic")))
vir_cols <- viridis(2, begin = 0, end = 0.75)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
vir_cols <- viridis(2, begin = 0.2, end = 0.8)
past_color <- vir_cols[1]
present_color <- vir_cols[2]
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = 4, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 4, width = 8)
my_text_size <- 6
my_text_size <- 6
dat3 %>%
ggplot(aes(size1mm, fill = era)) +
geom_density(alpha = 0.75) +
facet_wrap( ~ species) +
scale_fill_manual(values = c(past_color, present_color)) +
xlab("Size (mm)") +
ylab("Probability density") +
theme(legend.position = "none") +
geom_vline(aes(xintercept = size_threshold),
linetype = "dashed", color = "black", alpha = 0.65) +
# geom_text(data = facet_panels, aes(0, 0.15, label = facet_labels),
#           inherit.aes = FALSE, size = 6, nudge_x = 1, nudge_y = 0.01) +
geom_text(data = facet_panels, aes(15, 0.115, label = past_text),
inherit.aes = FALSE, size = my_text_size, nudge_x = 1, nudge_y = 0.01, color = past_color, hjust = 0) +
geom_text(data = facet_panels, aes(15, 0.1, label = present_text),
inherit.aes = FALSE, size = my_text_size, nudge_x = 1, nudge_y = 0.01, color = present_color, hjust = 0)
ggsave("figs_ms/plot_size_frequency_density_ppt.pdf", height = 5, width = 10)
library(dplyr)
options(dplyr.print_max = 100)
library(tidyr)
library(ggplot2)
library(readr)
library(readxl)
library(cowplot)
theme_set(theme_bw(base_size = 12) +
theme(strip.background = element_blank(),
panel.grid = element_blank()))
source("hewatt_transect/load_snail_size_data.R")
## Load all data for exploration
dat <- load_snail_size_data(remove_rare = FALSE)
str(dat)
# 19 quadrats per year, species must be present in > 5% of quads
n_quads <- length(unique(dat$quadrat))
n_yrs <- length(unique(dat$year))
exp(2)
library(dplyr)
library(readr)
library(ggplot2)
theme_set(theme_bw(base_size = 12) +
theme(panel.grid = element_blank(),
strip.background = element_blank()))
library(viridis)
elahi <- read_csv("sbs_meta/output/dfMeta_Elahi2015.csv")
fisher <- read_csv("sbs_meta/output/dfMeta_Fisher2009.csv")
gall_frank <- read_csv("sbs_meta/output/dfMeta_Galloway-Frank_2017.csv")
gall_tren <- read_csv("sbs_meta/output/dfMeta_Galloway-Treneman_2017.csv")
hay_king <- read_csv("sbs_meta/output/dfMeta_Hayford-King_2017.csv")
roy <- read_csv("sbs_meta/output/dfMeta_Roy2003.csv")
dat <- rbind(elahi, fisher, gall_frank, gall_tren, hay_king, roy)
## Remove CNM, then rename Site
dat <- dat %>%
filter(site != "CNM") %>%
mutate(site = ifelse(study == "Roy_2003", "SoCal", site)) %>%
mutate(group = paste(study, species, site, sep = "-"),
museum = ifelse(museum == TRUE, "museum", "field"),
sample_size = as.numeric(sample_size))
## Change SD to CI
str(dat)
dat <- dat %>%
mutate(size_CI = ifelse(study == "Roy_2003", size_error, 2 * (size_error / sqrt(sample_size))))
## Plot untransformed data
dat %>%
#filter(species != "Lottia gigantea") %>%
ggplot(aes(year, size_rep, color = species, shape = study, group = group)) +
geom_point(size = 3, alpha = 0.75) +
geom_line(aes(group = group), size = 0.5, alpha = 0.75) +
#geom_errorbar(aes(ymax = size_rep + size_CI, ymin = size_rep - size_CI), size = 1, width = 5) +
labs(x = "Year",
y = "Mean size (mm)") +
scale_color_viridis_d() +
facet_wrap(~ museum) +
theme(legend.position = "right")
library(dplyr)
library(readr)
library(ggplot2)
theme_set(theme_bw(base_size = 12) +
theme(panel.grid = element_blank(),
strip.background = element_blank()))
library(viridis)
elahi <- read_csv("sbs_meta/output/dfMeta_Elahi2015.csv")
fisher <- read_csv("sbs_meta/output/dfMeta_Fisher2009.csv")
gall_frank <- read_csv("sbs_meta/output/dfMeta_Galloway-Frank_2017.csv")
gall_frank <- read_csv("sbs_meta/output/dfMeta_Galloway-Frank_2017.csv")
fisher <- read_csv("sbs_meta/output/dfMeta_Fisher2009.csv")
fisher <- read_csv("sbs_meta/output/dfMeta_Fisher2009_original.csv")
gall_frank <- read_csv("sbs_meta/output/dfMeta_Galloway-Frank_2017.csv")
gall_tren <- read_csv("sbs_meta/output/dfMeta_Galloway-Treneman_2017.csv")
hay_king <- read_csv("sbs_meta/output/dfMeta_Hayford-King_2017.csv")
roy <- read_csv("sbs_meta/output/dfMeta_Roy2003.csv")
dat <- rbind(elahi, fisher, gall_frank, gall_tren, hay_king, roy)
dat <- read_csv("sbs_meta/output/dfMeta_Hayford-King_2017.csv")
## Plot untransformed data
dat %>%
#filter(species != "Lottia gigantea") %>%
ggplot(aes(year, size_rep, color = species, shape = study, group = group)) +
geom_point(size = 3, alpha = 0.75) +
geom_line(aes(group = group), size = 0.5, alpha = 0.75) +
#geom_errorbar(aes(ymax = size_rep + size_CI, ymin = size_rep - size_CI), size = 1, width = 5) +
labs(x = "Year",
y = "Mean size (mm)") +
scale_color_viridis_d() +
facet_wrap(~ museum) +
theme(legend.position = "right")
## Plot untransformed data
dat %>%
#filter(species != "Lottia gigantea") %>%
ggplot(aes(year, size_rep, color = species, shape = study)) +
geom_point(size = 3, alpha = 0.75) +
geom_line(aes(group = group), size = 0.5, alpha = 0.75) +
#geom_errorbar(aes(ymax = size_rep + size_CI, ymin = size_rep - size_CI), size = 1, width = 5) +
labs(x = "Year",
y = "Mean size (mm)") +
scale_color_viridis_d() +
facet_wrap(~ museum) +
theme(legend.position = "right")
names(dat)
View(dat)
library(dplyr)
library(tidyr)
library(readr)
library(ggplot2)
source("R/convert_histo_to_raw.R")
source("R/choose_size_threshold.R")
remove_last_char <- function(t) substr(t, 1, nchar(t)-1)
ackerman <- read_csv("sbs_meta/scraped/HayfordKing_2017/biogeo_size_change - size_raw_HHWK.csv")
ackerman
names(ackerman)
ackerman <- ackerman %>% mutate(Shaw_hab = NA, notes = "", notes2 = "")
# Get random sizes from binned data
ack_past <- ackerman %>%
filter(era == "past")
ack_past_histo <- ack_past %>% count(size1mm)
# Normally distributed sizes
ack_past_size_norm <- get_random_sizes(size_bin_vector = ack_past_histo$size1mm,
count_vector = ack_past_histo$n, size_interval = 1,
distribution = "normal")
# Uniformally distributed sizes
ack_past_size_unif <- get_random_sizes(size_bin_vector = ack_past_histo$size1mm,
count_vector = ack_past_histo$n, size_interval = 1,
distribution = "uniform")
plot(ack_past$size1mm, ack_past_size_norm)
plot(ack_past$size1mm, ack_past_size_unif)
hist(ack_past_size_norm, breaks = 30)
hist(ack_past_size_unif, breaks = 30)
names(ack_past)
# Use uniformly distributed sizes
ack_past$size1mm_rand <- ack_past_size_unif
ack_pres <- ackerman %>% filter(era == "present") %>%
mutate(size1mm_rand = size1mm)
ackerman2 <- rbind(ack_pres, ack_past)
ackerman2 %>% distinct(date)
ackerman2 <- ackerman2 %>% mutate(year = ifelse(era == "past", 1964, 2017))
ackerman2 %>% count(era)
ackerman2 <- ackerman2 %>%
mutate(lat = as.numeric(remove_last_char(as.character(lat))),
long = -as.numeric(remove_last_char(as.character(long))))
# Size threshold for museum comparison
dat <- ackerman2 %>% mutate(size_threshold = 0)
dat_sub <- choose_size_threshold_general(dat, era = "combined", my_quantile = 0.5)
dat %>% count(species, era)
dat_sub %>% count(species, era)
##### PLOT HISTOS #####
library(ggplot2)
theme_set(theme_bw(base_size = 12) +
theme(panel.grid = element_blank(),
strip.background = element_blank()))
names(dat)
dat %>%
ggplot(aes(size1mm)) +
facet_wrap(~ era)
dat %>%
ggplot(aes(size1mm)) +
geom_histogram(binwidth = 2) +
facet_wrap(~ era)
dat %>%
ggplot(aes(size1mm)) +
geom_histogram(binwidth = 2, color = "black", fill = "gray") +
facet_wrap(~ era)
dat %>%
ggplot(aes(size1mm)) +
geom_histogram(binwidth = 2, color = "black", fill = "gray") +
facet_wrap(~ era, ncol = 1)
dat %>%
ggplot(aes(size1mm, fill = era)) +
geom_histogram(binwidth = 2, color = "black")
dat %>%
ggplot(aes(size1mm, fill = era)) +
geom_histogram(binwidth = 2, color = "black", alpha = 0.5)
dat %>%
ggplot(aes(size1mm)) +
geom_histogram(binwidth = 2, color = "black", fill = "gray") +
facet_wrap(~ era, ncol = 1)
